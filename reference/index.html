<!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->



<!doctype html>
<html lang="en" class="no-js">
  <head>

    <!-- Meta tags -->
    
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />

      <!-- Page description -->
      

      <!-- Page author -->
      

      <!-- Canonical -->
      

      <!-- Previous page -->
      
        <link rel="prev" href=".." />
      

      <!-- Next page -->
      
        <link rel="next" href="../contribution_guide/" />
      

      <!-- RSS feed -->
      

      <!-- Favicon -->
      <link rel="icon" href="../assets/images/favicon.ico" />

      <!-- Generator banner -->
      <meta
        name="generator"
        content="mkdocs-1.6.0, $md-name$-$md-version$"
      />
    

    <!-- Site title -->
    
      
        <title>API Reference - rdsa-utils Documentation</title>
      
    

    <!-- Theme-related style sheets -->
    
      <link rel="stylesheet" href="../assets/stylesheets/main.css" />

      <!-- Extra color palette -->
      

      <!-- Custom icons -->
      


    

    <!-- JavaScript libraries -->
    
      
    

    <!-- Webfonts -->
    

      <!-- Load fonts from Google -->
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
          rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"
        />
        <style>
          :root {
            --md-text-font: "Roboto";
            --md-code-font: "Roboto Mono";
          }
        </style>
      
    

    <!-- Custom style sheets -->
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css" />
    

    <!-- Helper functions for inline scripts -->
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>

    <!-- Meta tags from front matter or plugins -->
    

    <!-- Custom front matter -->
    
  </head>

  <!-- Set text direction and color palette, if defined -->
  
  
    <body dir="ltr">
  
    

    <!--
      State toggles - we need to set autocomplete="off" in order to reset the
      drawer on back button invocation in some browsers
    -->
    <input
      class="md-toggle"
      data-md-toggle="drawer"
      type="checkbox"
      id="__drawer"
      autocomplete="off"
    />
    <input
      class="md-toggle"
      data-md-toggle="search"
      type="checkbox"
      id="__search"
      autocomplete="off"
    />

    <!-- Overlay for expanded drawer -->
    <label class="md-overlay" for="__drawer"></label>

    <!-- Skip to content -->
    <div data-md-component="skip">
      
        
        <a href="#general" class="md-skip">
          Skip to content
        </a>
      
    </div>

    <!-- Announcement bar -->
    <div data-md-component="announce">
      
    </div>

    <!-- Version warning -->
    

    <!-- Header -->
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="rdsa-utils Documentation" class="md-header__button md-logo" aria-label="rdsa-utils Documentation" data-md-component="logo">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rdsa-utils Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ONSdigital/rdsa-utils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    rdsa-utils
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  rdsa-utils

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contribution_guide/" class="md-tabs__link">
        
  
    
  
  Contribution Guide

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../branch_and_deploy_guide/" class="md-tabs__link">
        
  
    
  
  Branching & Deployment Guide

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../guides/cdp_aws_resource_estimator/" class="md-tabs__link">
          
  
  Guides

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    

    <!-- Container -->
    <div class="md-container" data-md-component="container">

      <!-- Hero teaser -->
      

      <!-- Navigation tabs (collapsing) -->
      
        
      

      <!-- Main area -->
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">

          <!-- Sidebars -->
          

            <!-- Navigation -->
            
              
              <div
                class="md-sidebar md-sidebar--primary"
                data-md-component="sidebar"
                data-md-type="navigation"
                
              >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="rdsa-utils Documentation" class="md-nav__button md-logo" aria-label="rdsa-utils Documentation" data-md-component="logo">
      
  <img src="../assets/images/logo.svg" alt="logo">

    </a>
    rdsa-utils Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ONSdigital/rdsa-utils" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    rdsa-utils
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rdsa-utils
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general" class="md-nav__link">
    <span class="md-ellipsis">
      General
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      exceptions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="exceptions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.ColumnNotInDataframeError" class="md-nav__link">
    <span class="md-ellipsis">
      ColumnNotInDataframeError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.ConfigError" class="md-nav__link">
    <span class="md-ellipsis">
      ConfigError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.DataframeEmptyError" class="md-nav__link">
    <span class="md-ellipsis">
      DataframeEmptyError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.InvalidBucketNameError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidBucketNameError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.InvalidS3FilePathError" class="md-nav__link">
    <span class="md-ellipsis">
      InvalidS3FilePathError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.PipelineError" class="md-nav__link">
    <span class="md-ellipsis">
      PipelineError
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.exceptions.TableNotFoundError" class="md-nav__link">
    <span class="md-ellipsis">
      TableNotFoundError
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.logging" class="md-nav__link">
    <span class="md-ellipsis">
      logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.add_warning_message_to_function" class="md-nav__link">
    <span class="md-ellipsis">
      add_warning_message_to_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.init_logger_advanced" class="md-nav__link">
    <span class="md-ellipsis">
      init_logger_advanced
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.init_logger_basic" class="md-nav__link">
    <span class="md-ellipsis">
      init_logger_basic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.log_dev" class="md-nav__link">
    <span class="md-ellipsis">
      log_dev
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.log_rows_in_spark_df" class="md-nav__link">
    <span class="md-ellipsis">
      log_rows_in_spark_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.log_spark_df_schema" class="md-nav__link">
    <span class="md-ellipsis">
      log_spark_df_schema
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.print_full_table_and_raise_error" class="md-nav__link">
    <span class="md-ellipsis">
      print_full_table_and_raise_error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.logging.timer_args" class="md-nav__link">
    <span class="md-ellipsis">
      timer_args
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils" class="md-nav__link">
    <span class="md-ellipsis">
      test_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="test_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.Case" class="md-nav__link">
    <span class="md-ellipsis">
      Case
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.Case.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.create_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      create_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.create_spark_df" class="md-nav__link">
    <span class="md-ellipsis">
      create_spark_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.parametrize_cases" class="md-nav__link">
    <span class="md-ellipsis">
      parametrize_cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.spark_session" class="md-nav__link">
    <span class="md-ellipsis">
      spark_session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.suppress_py4j_logging" class="md-nav__link">
    <span class="md-ellipsis">
      suppress_py4j_logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.to_date" class="md-nav__link">
    <span class="md-ellipsis">
      to_date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.to_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      to_datetime
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.test_utils.to_spark" class="md-nav__link">
    <span class="md-ellipsis">
      to_spark
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.typing" class="md-nav__link">
    <span class="md-ellipsis">
      typing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.validation" class="md-nav__link">
    <span class="md-ellipsis">
      validation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.validation.allowed_date_format" class="md-nav__link">
    <span class="md-ellipsis">
      allowed_date_format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.validation.apply_validation" class="md-nav__link">
    <span class="md-ellipsis">
      apply_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.validation.list_convert_validator" class="md-nav__link">
    <span class="md-ellipsis">
      list_convert_validator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cdp" class="md-nav__link">
    <span class="md-ellipsis">
      CDP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils" class="md-nav__link">
    <span class="md-ellipsis">
      s3_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="s3_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.check_file" class="md-nav__link">
    <span class="md-ellipsis">
      check_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.copy_file" class="md-nav__link">
    <span class="md-ellipsis">
      copy_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.create_folder" class="md-nav__link">
    <span class="md-ellipsis">
      create_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.delete_folder" class="md-nav__link">
    <span class="md-ellipsis">
      delete_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.delete_old_objects_and_folders" class="md-nav__link">
    <span class="md-ellipsis">
      delete_old_objects_and_folders
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.download_folder" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.file_exists" class="md-nav__link">
    <span class="md-ellipsis">
      file_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.file_size" class="md-nav__link">
    <span class="md-ellipsis">
      file_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.is_s3_directory" class="md-nav__link">
    <span class="md-ellipsis">
      is_s3_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.list_files" class="md-nav__link">
    <span class="md-ellipsis">
      list_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.load_json" class="md-nav__link">
    <span class="md-ellipsis">
      load_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.md5_sum" class="md-nav__link">
    <span class="md-ellipsis">
      md5_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.read_header" class="md-nav__link">
    <span class="md-ellipsis">
      read_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.remove_leading_slash" class="md-nav__link">
    <span class="md-ellipsis">
      remove_leading_slash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.s3_walk" class="md-nav__link">
    <span class="md-ellipsis">
      s3_walk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      upload_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.upload_folder" class="md-nav__link">
    <span class="md-ellipsis">
      upload_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.validate_bucket_name" class="md-nav__link">
    <span class="md-ellipsis">
      validate_bucket_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.validate_s3_file_path" class="md-nav__link">
    <span class="md-ellipsis">
      validate_s3_file_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.write_csv" class="md-nav__link">
    <span class="md-ellipsis">
      write_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.write_excel" class="md-nav__link">
    <span class="md-ellipsis">
      write_excel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.write_string_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_string_to_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.zip_local_directory_to_s3" class="md-nav__link">
    <span class="md-ellipsis">
      zip_local_directory_to_s3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.s3_utils.zip_s3_directory_to_s3" class="md-nav__link">
    <span class="md-ellipsis">
      zip_s3_directory_to_s3
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils" class="md-nav__link">
    <span class="md-ellipsis">
      hdfs_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hdfs_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.change_permissions" class="md-nav__link">
    <span class="md-ellipsis">
      change_permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.copy_local_to_hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      copy_local_to_hdfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.create_dir" class="md-nav__link">
    <span class="md-ellipsis">
      create_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.create_txt_from_string" class="md-nav__link">
    <span class="md-ellipsis">
      create_txt_from_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.delete_dir" class="md-nav__link">
    <span class="md-ellipsis">
      delete_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.delete_path" class="md-nav__link">
    <span class="md-ellipsis">
      delete_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.file_exists" class="md-nav__link">
    <span class="md-ellipsis">
      file_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.get_date_modified" class="md-nav__link">
    <span class="md-ellipsis">
      get_date_modified
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.is_dir" class="md-nav__link">
    <span class="md-ellipsis">
      is_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.move_local_to_hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      move_local_to_hdfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.read_dir" class="md-nav__link">
    <span class="md-ellipsis">
      read_dir
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.read_dir_files" class="md-nav__link">
    <span class="md-ellipsis">
      read_dir_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.read_dir_files_recursive" class="md-nav__link">
    <span class="md-ellipsis">
      read_dir_files_recursive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.hdfs_utils.rename" class="md-nav__link">
    <span class="md-ellipsis">
      rename
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.impala" class="md-nav__link">
    <span class="md-ellipsis">
      impala
    </span>
  </a>
  
    <nav class="md-nav" aria-label="impala">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.helpers.impala.invalidate_impala_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      invalidate_impala_metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog" class="md-nav__link">
    <span class="md-ellipsis">
      pipeline_runlog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pipeline_runlog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.add_runlog_entry" class="md-nav__link">
    <span class="md-ellipsis">
      add_runlog_entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.create_runlog_entry" class="md-nav__link">
    <span class="md-ellipsis">
      create_runlog_entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.create_runlog_table" class="md-nav__link">
    <span class="md-ellipsis">
      create_runlog_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.get_last_run_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_last_run_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.get_penultimate_run_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_penultimate_run_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.reserve_id" class="md-nav__link">
    <span class="md-ellipsis">
      reserve_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.pipeline_runlog.write_runlog_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_runlog_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.input" class="md-nav__link">
    <span class="md-ellipsis">
      input
    </span>
  </a>
  
    <nav class="md-nav" aria-label="input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.input.extract_database_name" class="md-nav__link">
    <span class="md-ellipsis">
      extract_database_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.input.get_current_database" class="md-nav__link">
    <span class="md-ellipsis">
      get_current_database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.input.get_tables_in_database" class="md-nav__link">
    <span class="md-ellipsis">
      get_tables_in_database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.input.load_and_validate_table" class="md-nav__link">
    <span class="md-ellipsis">
      load_and_validate_table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.output" class="md-nav__link">
    <span class="md-ellipsis">
      output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.output.insert_df_to_hive_table" class="md-nav__link">
    <span class="md-ellipsis">
      insert_df_to_hive_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.output.save_csv_to_hdfs" class="md-nav__link">
    <span class="md-ellipsis">
      save_csv_to_hdfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.output.save_csv_to_s3" class="md-nav__link">
    <span class="md-ellipsis">
      save_csv_to_s3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.cdp.io.output.write_and_read_hive_table" class="md-nav__link">
    <span class="md-ellipsis">
      write_and_read_hive_table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gcp" class="md-nav__link">
    <span class="md-ellipsis">
      GCP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils" class="md-nav__link">
    <span class="md-ellipsis">
      gcp_utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="gcp_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.copy_file" class="md-nav__link">
    <span class="md-ellipsis">
      copy_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.create_folder_on_gcs" class="md-nav__link">
    <span class="md-ellipsis">
      create_folder_on_gcs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.delete_file" class="md-nav__link">
    <span class="md-ellipsis">
      delete_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.delete_folder" class="md-nav__link">
    <span class="md-ellipsis">
      delete_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.download_file" class="md-nav__link">
    <span class="md-ellipsis">
      download_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.download_folder" class="md-nav__link">
    <span class="md-ellipsis">
      download_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.file_exists" class="md-nav__link">
    <span class="md-ellipsis">
      file_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.get_table_columns" class="md-nav__link">
    <span class="md-ellipsis">
      get_table_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.is_gcs_directory" class="md-nav__link">
    <span class="md-ellipsis">
      is_gcs_directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.list_files" class="md-nav__link">
    <span class="md-ellipsis">
      list_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.load_config_gcp" class="md-nav__link">
    <span class="md-ellipsis">
      load_config_gcp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.move_file" class="md-nav__link">
    <span class="md-ellipsis">
      move_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.remove_leading_slash" class="md-nav__link">
    <span class="md-ellipsis">
      remove_leading_slash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.run_bq_query" class="md-nav__link">
    <span class="md-ellipsis">
      run_bq_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.table_exists" class="md-nav__link">
    <span class="md-ellipsis">
      table_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.upload_file" class="md-nav__link">
    <span class="md-ellipsis">
      upload_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.upload_folder" class="md-nav__link">
    <span class="md-ellipsis">
      upload_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.helpers.gcp_utils.validate_bucket_name" class="md-nav__link">
    <span class="md-ellipsis">
      validate_bucket_name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.io.inputs" class="md-nav__link">
    <span class="md-ellipsis">
      inputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="inputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.io.inputs.build_sql_query" class="md-nav__link">
    <span class="md-ellipsis">
      build_sql_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.io.inputs.read_table" class="md-nav__link">
    <span class="md-ellipsis">
      read_table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.io.outputs" class="md-nav__link">
    <span class="md-ellipsis">
      outputs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="outputs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.gcp.io.outputs.write_table" class="md-nav__link">
    <span class="md-ellipsis">
      write_table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helpers" class="md-nav__link">
    <span class="md-ellipsis">
      Helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark" class="md-nav__link">
    <span class="md-ellipsis">
      pyspark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pyspark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.aggregate_col" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.apply_col_func" class="md-nav__link">
    <span class="md-ellipsis">
      apply_col_func
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.cache_time_df" class="md-nav__link">
    <span class="md-ellipsis">
      cache_time_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.calc_median_price" class="md-nav__link">
    <span class="md-ellipsis">
      calc_median_price
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.convert_cols_to_struct_col" class="md-nav__link">
    <span class="md-ellipsis">
      convert_cols_to_struct_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.convert_struc_col_to_columns" class="md-nav__link">
    <span class="md-ellipsis">
      convert_struc_col_to_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.count_nulls" class="md-nav__link">
    <span class="md-ellipsis">
      count_nulls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.create_colname_to_value_map" class="md-nav__link">
    <span class="md-ellipsis">
      create_colname_to_value_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.create_spark_session" class="md-nav__link">
    <span class="md-ellipsis">
      create_spark_session
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.cumulative_array" class="md-nav__link">
    <span class="md-ellipsis">
      cumulative_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.cut_lineage" class="md-nav__link">
    <span class="md-ellipsis">
      cut_lineage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.drop_duplicates_reproducible" class="md-nav__link">
    <span class="md-ellipsis">
      drop_duplicates_reproducible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.filter_out_values" class="md-nav__link">
    <span class="md-ellipsis">
      filter_out_values
    </span>
  </a>
  
    <nav class="md-nav" aria-label="filter_out_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.filter_out_values--keep-nulls-default" class="md-nav__link">
    <span class="md-ellipsis">
      Keep nulls (default)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.filter_out_values--exclude-nulls" class="md-nav__link">
    <span class="md-ellipsis">
      Exclude nulls
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.find_spark_dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      find_spark_dataframes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.get_unique" class="md-nav__link">
    <span class="md-ellipsis">
      get_unique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.get_window_spec" class="md-nav__link">
    <span class="md-ellipsis">
      get_window_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.is_df_empty" class="md-nav__link">
    <span class="md-ellipsis">
      is_df_empty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.join_multi_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      join_multi_dfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.load_csv" class="md-nav__link">
    <span class="md-ellipsis">
      load_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.map_column_names" class="md-nav__link">
    <span class="md-ellipsis">
      map_column_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.map_column_values" class="md-nav__link">
    <span class="md-ellipsis">
      map_column_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.melt" class="md-nav__link">
    <span class="md-ellipsis">
      melt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.pyspark_random_uniform" class="md-nav__link">
    <span class="md-ellipsis">
      pyspark_random_uniform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.rank_numeric" class="md-nav__link">
    <span class="md-ellipsis">
      rank_numeric
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.select_first_obs_appearing_in_group" class="md-nav__link">
    <span class="md-ellipsis">
      select_first_obs_appearing_in_group
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.set_df_columns_nullable" class="md-nav__link">
    <span class="md-ellipsis">
      set_df_columns_nullable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.set_nulls" class="md-nav__link">
    <span class="md-ellipsis">
      set_nulls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.smart_coalesce" class="md-nav__link">
    <span class="md-ellipsis">
      smart_coalesce
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.sum_columns" class="md-nav__link">
    <span class="md-ellipsis">
      sum_columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.to_list" class="md-nav__link">
    <span class="md-ellipsis">
      to_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.to_spark_col" class="md-nav__link">
    <span class="md-ellipsis">
      to_spark_col
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.truncate_external_hive_table" class="md-nav__link">
    <span class="md-ellipsis">
      truncate_external_hive_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.union_mismatched_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      union_mismatched_dfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.union_multi_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      union_multi_dfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.pyspark.unpack_list_col" class="md-nav__link">
    <span class="md-ellipsis">
      unpack_list_col
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python" class="md-nav__link">
    <span class="md-ellipsis">
      python
    </span>
  </a>
  
    <nav class="md-nav" aria-label="python">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.always_iterable_local" class="md-nav__link">
    <span class="md-ellipsis">
      always_iterable_local
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.calc_product_of_dict_values" class="md-nav__link">
    <span class="md-ellipsis">
      calc_product_of_dict_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.check_file" class="md-nav__link">
    <span class="md-ellipsis">
      check_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.convert_date_strings_to_datetimes" class="md-nav__link">
    <span class="md-ellipsis">
      convert_date_strings_to_datetimes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.convert_types_iterable" class="md-nav__link">
    <span class="md-ellipsis">
      convert_types_iterable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.create_folder" class="md-nav__link">
    <span class="md-ellipsis">
      create_folder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create_folder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.create_folder--the-directory-example_foldersubfolder-will-be-created-if-it-does-not-exist" class="md-nav__link">
    <span class="md-ellipsis">
      The directory "example_folder/subfolder" will be created if it does not exist.
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.directory_exists" class="md-nav__link">
    <span class="md-ellipsis">
      directory_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.dump_environment_requirements" class="md-nav__link">
    <span class="md-ellipsis">
      dump_environment_requirements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.extend_lists" class="md-nav__link">
    <span class="md-ellipsis">
      extend_lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.file_exists" class="md-nav__link">
    <span class="md-ellipsis">
      file_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.file_size" class="md-nav__link">
    <span class="md-ellipsis">
      file_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.flatten_iterable" class="md-nav__link">
    <span class="md-ellipsis">
      flatten_iterable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.interleave_iterables" class="md-nav__link">
    <span class="md-ellipsis">
      interleave_iterables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.list_convert" class="md-nav__link">
    <span class="md-ellipsis">
      list_convert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.md5_sum" class="md-nav__link">
    <span class="md-ellipsis">
      md5_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.merge_multi_dfs" class="md-nav__link">
    <span class="md-ellipsis">
      merge_multi_dfs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.overwrite_dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      overwrite_dictionary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.pairwise_iterable" class="md-nav__link">
    <span class="md-ellipsis">
      pairwise_iterable
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.read_header" class="md-nav__link">
    <span class="md-ellipsis">
      read_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.setdiff" class="md-nav__link">
    <span class="md-ellipsis">
      setdiff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.time_it" class="md-nav__link">
    <span class="md-ellipsis">
      time_it
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.tuple_convert" class="md-nav__link">
    <span class="md-ellipsis">
      tuple_convert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.write_string_to_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_string_to_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="write_string_to_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.helpers.python.write_string_to_file--the-content-hello-world-will-be-written-to-exampletxt" class="md-nav__link">
    <span class="md-ellipsis">
      The content "Hello, World!" will be written to "example.txt"
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      IO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.io.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.config.LoadConfig" class="md-nav__link">
    <span class="md-ellipsis">
      LoadConfig
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.io.input" class="md-nav__link">
    <span class="md-ellipsis">
      input
    </span>
  </a>
  
    <nav class="md-nav" aria-label="input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.input.parse_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.input.parse_toml" class="md-nav__link">
    <span class="md-ellipsis">
      parse_toml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.input.parse_yaml" class="md-nav__link">
    <span class="md-ellipsis">
      parse_yaml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.input.read_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.io.output" class="md-nav__link">
    <span class="md-ellipsis">
      output
    </span>
  </a>
  
    <nav class="md-nav" aria-label="output">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.io.output.zip_folder" class="md-nav__link">
    <span class="md-ellipsis">
      zip_folder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    <span class="md-ellipsis">
      Methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods" class="md-nav__link">
    <span class="md-ellipsis">
      averaging_methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="averaging_methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods.get_weight_shares" class="md-nav__link">
    <span class="md-ellipsis">
      get_weight_shares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods.unweighted_arithmetic_average" class="md-nav__link">
    <span class="md-ellipsis">
      unweighted_arithmetic_average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods.unweighted_geometric_average" class="md-nav__link">
    <span class="md-ellipsis">
      unweighted_geometric_average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods.weighted_arithmetic_average" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_arithmetic_average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdsa_utils.methods.averaging_methods.weighted_geometric_average" class="md-nav__link">
    <span class="md-ellipsis">
      weighted_geometric_average
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contribution_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../branch_and_deploy_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Branching & Deployment Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/cdp_aws_resource_estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CDP AWS Resource Estimator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            

            <!-- Table of contents -->
            
          

          <!-- Page content -->
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>API Reference</h1>

<p>This part of the project documentation focuses on an <strong>information-oriented</strong> approach. Use it as a
reference for the technical implementation of the<code>rdsa-utils</code> codebase.</p>
<h2 id="general">General</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.exceptions" class="doc doc-heading">
            <code>rdsa_utils.exceptions</code>


</h2>

    <div class="doc doc-contents first">

        <p>Common custom exceptions that can be raised in pipelines.</p>
<p>The purpose of these is to provide a clearer indication of why an error is
being raised over the standard builtin errors (e.g. <code>ColumnNotInDataframeError</code>
vs <code>ValueError</code>).</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.ColumnNotInDataframeError" class="doc doc-heading">
            <code>ColumnNotInDataframeError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when a column is not present in dataframe.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.ConfigError" class="doc doc-heading">
            <code>ConfigError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when there is an issue in a config object.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.DataframeEmptyError" class="doc doc-heading">
            <code>DataframeEmptyError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when a dataframe is empty.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.InvalidBucketNameError" class="doc doc-heading">
            <code>InvalidBucketNameError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when an AWS S3 or GCS bucket name is invalid.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.InvalidS3FilePathError" class="doc doc-heading">
            <code>InvalidS3FilePathError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when an AWS S3 file path is invalid.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.PipelineError" class="doc doc-heading">
            <code>PipelineError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when there is a generic pipeline issue.</p>








    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.exceptions.TableNotFoundError" class="doc doc-heading">
            <code>TableNotFoundError</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>


        <p>Custom exception to raise when a table to be read is not found.</p>








    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.logging" class="doc doc-heading">
            <code>rdsa_utils.logging</code>


</h2>

    <div class="doc doc-contents first">

        <p>Contains the logging configuration for files and method to initialise it.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.add_warning_message_to_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_warning_message_to_function</span><span class="p">(</span><span class="n">_func</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply decorator to log a warning message.</p>
<p>If a message is passed, this decorator adds a warning log of the form
function_name: message</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to be logged along with the function name.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Explainer on complex decorators (and template for decorator structure):
https://realpython.com/primer-on-python-decorators/#both-please-but-never-mind-the-bread</p>
</details>

<details class="usage" open>
  <summary>Usage</summary>
  <p>To use decorator to log a warning:</p>
<pre><code class="language-python">&gt;&gt;&gt; @_add_warning_message_to_function(message='here be dragons...')
&gt;&gt;&gt; def my_func(some_args, some_other_args):
&gt;&gt;&gt;    ...
&gt;&gt;&gt;
&gt;&gt;&gt; some_output = my_func(...)

Warning my_func: here be dragons...
</code></pre>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.init_logger_advanced" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_logger_advanced</span><span class="p">(</span><span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">handlers</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Handler</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set up the root logger with specified settings, avoiding duplicate handlers.</p>
<p>This function initialises the root logger at the desired log_level,
applies a consistent message and date format, and attaches any provided
handlers. If the root logger already has handlers (e.g., from a previous
call or another module), it returns immediately to prevent duplicate setup.</p>
<p>Recommended usage: call this function once during application startup
ideally in your packages top-level <code>__init__.py</code> - to enforce consistent
logging configuration across all modules.</p>
<p>After initialisation, modules should obtain their
own logger via: <code>logger = logging.getLogger(__name__)</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level (e.g., logging.INFO, logging.DEBUG) for all messages
emitted by the root logger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>handlers</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="logging.Handler">Handler</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of handler instances (e.g., StreamHandler, FileHandler) to attach.
If None or empty, <code>logging.basicConfig</code> is used with the given formats.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>logging.Formatter</code> format string for log messages.
Defaults to: "%(asctime)s %(levelname)s %(name)s: %(message)s".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A strftime format string for timestamps.
Defaults to: "%Y-%m-%d %H:%M:%S".</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any item in handlers is not an instance of <code>logging.Handler</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Checks <code>root_logger.hasHandlers()</code>: if True, exits without changes.</li>
<li>Sets the root logger's level to log_level before adding handlers.</li>
<li>If no handlers provided, calls <code>logging.basicConfig</code> after formatter setup.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">logging</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdsa_utils.logging</span> <span class="kn">import</span> <span class="n">init_logger_advanced</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialise once in your packages __init__.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_logger_advanced</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">handlers</span><span class="o">=</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)],</span>
<span class="gp">... </span>    <span class="n">log_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(levelname)s</span><span class="s2">: </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">date_format</span><span class="o">=</span><span class="s2">&quot;%H:%M:%S&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># In other modules, get a named logger</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.init_logger_basic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">init_logger_basic</span><span class="p">(</span><span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Instantiate a basic logger object to be used across modules.</p>
<p>By using this function to instantiate the logger, you also have access to
<code>logger.dev</code> for log_level=15, as this is defined in the same module scope
as this function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The level of logging to be recorded. Can be defined either as the
integer level or the logging.<LEVEL> values in line with the
definitions of the logging module
(see - https://docs.python.org/3/library/logging.html#levels)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logger created by this function is available in any other modules
by using <code>logger = logging.getLogger(__name__)</code> at the global scope
level in a module (i.e. below imports, not in a function).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.log_dev" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_dev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a custom log level between INFO and DEBUG named DEV.</p>
<p>This is lifted from: https://stackoverflow.com/a/13638084</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.log_rows_in_spark_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_rows_in_spark_df</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply decorator to log dataframe row count before and after a function.</p>
<p>Requires that the function being decorated has a parameter called <code>df</code> and
that the function is called with <code>df</code> being a keyword argument (e.g.
<code>df=df</code>). If not the decorator will report back that it could not count the
number of rows of the dataframe before running the decorated function.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <pre><code class="language-python">@log_rows_in_spark_df
def my_func_that_changes_no_rows(some_args, df, some_other_args):
   ...
   returns final_df

some_df = my_func_that_changes_no_rows(
    some_args='hello',
    df=input_df,
    some_other_args='world'
)

&gt;&gt;&gt; Rows in dataframe before my_func_that_changes_no_rows : 12345
&gt;&gt;&gt; Rows in dataframe after my_func_that_changes_no_rows  : 6789
</code></pre>
</details>

<details class="warning:" open>
  <summary>Warning:</summary>
  <p><code>.count()</code> is an expensive spark operation to perform. Overuse of this
decorator can be detrimental to performance. This decorator will cache the
input dataframe prior to running the count and decorated function, as well
as persisting the output dataframe prior to counting. The input dataframe
is also unpersisted from memory prior to the decorator completing.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.log_spark_df_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_spark_df_schema</span><span class="p">(</span><span class="n">_func</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">log_schema_on_input</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply decorator to log dataframe schema before and after a function.</p>
<p>If you use the `df.printSchema() method directly in a print/log statement
the code is processed and printed regardless of logging leve. Instead you
need to capture the output and pass this to the logger. See explanaition
here - https://stackoverflow.com/a/59935109</p>
<p>Requires that the function being decorated has a parameter called <code>df</code> and
that the function is called with <code>df</code> being a keyword argument (e.g.
<code>df=df</code>). If not the decorator will report back that it could not count the
number of rows of the dataframe before running the decorated function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>log_schema_on_input</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to false, then no schema is attempted to be printed for the
decorated function on input. This is useful for instance where function
has no df input but does return one (such as when reading a table).</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Explainer on complex decorators (and template for decorator structure):
https://realpython.com/primer-on-python-decorators/#both-please-but-never-mind-the-bread</p>
</details>

<details class="usage" open>
  <summary>Usage</summary>
  <p>To use decorator to record input and output schema:</p>
<pre><code class="language-python">&gt;&gt;&gt; @log_spark_df_schema
&gt;&gt;&gt; def my_func_that_changes_some_columns(some_args, df, some_other_args):
&gt;&gt;&gt;    ...
&gt;&gt;&gt;    returns final_df
&gt;&gt;&gt;
&gt;&gt;&gt; some_df = my_func_that_changes_some_columns(
&gt;&gt;&gt;     some_args='hello',
&gt;&gt;&gt;     df=input_df,
&gt;&gt;&gt;     some_other_args='world'
&gt;&gt;&gt; )

Schema of dataframe before my_func_that_changes_some_columns:
root
|-- price: double (nullable = true)
|-- quantity: long (nullable = true)

Schema of dataframe after my_func_that_changes_some_columns:
root
|-- price: double (nullable = true)
|-- quantity: long (nullable = true)
|-- expenditure: double (nullable = true)
</code></pre>
<p>To use decorator to record output schema only:</p>
<pre><code class="language-python">&gt;&gt;&gt; @log_spark_df_schema(log_schema_on_input=False)
&gt;&gt;&gt; def my_func_that_changes_some_columns(some_args, df, some_other_args):
&gt;&gt;&gt;    ...
&gt;&gt;&gt;    returns final_df
&gt;&gt;&gt;
&gt;&gt;&gt; some_df = my_func_that_changes_some_columns(
&gt;&gt;&gt;     some_args='hello',
&gt;&gt;&gt;     df=input_df,
&gt;&gt;&gt;     some_other_args='world'
&gt;&gt;&gt; )

Not printing schema of dataframe before my_func_that_changes_some_columns

Schema of dataframe after my_func_that_changes_some_columns:
root
|-- price: double (nullable = true)
|-- quantity: long (nullable = true)
|-- expenditure: double (nullable = true)
</code></pre>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.print_full_table_and_raise_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_full_table_and_raise_error</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stop_pipeline</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">show_records</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Output dataframe records to logger.</p>
<p>The purpose of this function is to enable a user to output a message
to the logger with the added functionality of stopping the pipeline
and showing dataframe records in a table format. It may be used for
instance if a user wants to check the records in a dataframe when it
expected to be empty.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to display records from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>message</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The message to output to the logger.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stop_pipeline</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Switch for the user to stop the pipeline and raise an error.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_records</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Switch to show records in a dataframe.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Displays message to user however nothing is returned from
function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raises error and stops pipeline if switch applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.logging.timer_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timer_args</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initialise timer args workaround for 'text' args in codetiming package.</p>
<p>Works with codetiming==1.4.0</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the specific timer log.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logger</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="str">str</span>], None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional logger function that can accept a string argument.</p>
              </div>
            </td>
            <td>
                  <code><span title="rdsa_utils.logging.logger.info">info</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of arguments to pass to specifc codetiming package Timer.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.test_utils" class="doc doc-heading">
            <code>rdsa_utils.test_utils</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions and fixtures used with test suites.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.test_utils.Case" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">Case</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">marks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MarkDecorator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Container for a test case, with optional test ID.</p>
<p>The Case class is to be used in conjunction with <code>parameterize_cases</code>.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.test_utils.Case.    label">    label</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <pre><code>Optional test ID. Will be displayed for each test when
running `pytest -v`.
</code></pre>
<p>marks
    Optional pytest marks to denote any tests to skip etc.
kwargs
    Parameters used for the test cases.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <pre><code class="language-python">&gt;&gt;&gt; Case(label=&quot;some test name&quot;, foo=10, bar=&quot;some value&quot;)

&gt;&gt;&gt; Case(
&gt;&gt;&gt;     label=&quot;some test name&quot;,
&gt;&gt;&gt;     marks=pytest.mark.skip(reason='not implemented'),
&gt;&gt;&gt;     foo=10,
&gt;&gt;&gt;     bar=&quot;some value&quot;
&gt;&gt;&gt; )
</code></pre>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>Modified from https://github.com/ckp95/pytest-parametrize-cases to allow
pytest mark usage.</p>
</details>
        <p>Initialise objects.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="rdsa_utils.test_utils.Case.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return string.</p>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.create_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create pandas df from tuple data with a header.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.create_spark_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_spark_df</span><span class="p">(</span><span class="n">spark_session</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create Spark DataFrame from tuple data with first row as schema.</p>


<details class="example:" open>
  <summary>Example:</summary>
  <p>create_spark_df([
    ('column1', 'column2', 'column3'),
    ('aaaa', 1, 1.1)
])</p>
<p>Can specify the schema alongside the column names:
create_spark_df([
    ('column1 STRING, column2 INT, column3 DOUBLE'),
    ('aaaa', 1, 1.1)
])</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.parametrize_cases" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parametrize_cases</span><span class="p">(</span><span class="o">*</span><span class="n">cases</span><span class="p">:</span> <span class="n">Case</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>More user friendly parameterize cases testing.</p>
<p>Utilise as a decorator on top of test function.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <pre><code class="language-python">@parameterize_cases(
    Case(
        label=&quot;some test name&quot;,
        foo=10,
        bar=&quot;some value&quot;
    ),
    Case(
        label=&quot;some test name #2&quot;,
        foo=20,
        bar=&quot;some other value&quot;
    ),
)
def test(foo, bar):
    ...
</code></pre>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>Source: https://github.com/ckp95/pytest-parametrize-cases</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.spark_session" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">spark_session</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set up spark session fixture.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.suppress_py4j_logging" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">suppress_py4j_logging</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Suppress spark logging.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.to_date" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_date</span><span class="p">(</span><span class="n">dt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert date string to datetime.date type.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.to_datetime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_datetime</span><span class="p">(</span><span class="n">dt</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert datetime string to datetime.datetime type.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.test_utils.to_spark" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_spark</span><span class="p">(</span><span class="n">spark_session</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert pandas df to spark.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.typing" class="doc doc-heading">
            <code>rdsa_utils.typing</code>


</h2>

    <div class="doc doc-contents first">

        <p>Contains custom types for type hinting.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.validation" class="doc doc-heading">
            <code>rdsa_utils.validation</code>


</h2>

    <div class="doc doc-contents first">

        <p>Functions that support the use of pydantic validators.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.validation.allowed_date_format" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">allowed_date_format</span><span class="p">(</span><span class="n">date</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Ensure that the date string can be converted to a useable datetime.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The specified date string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input date.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the date is not one of the predefined allowed formats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.validation.apply_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_validation</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Validator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply validation model to config.</p>
<p>If no Validator is passed, then a warning will be logged and the input
config returned without validation. This mechanism is to allow the use of
this function to aid in tracking config sections that are unvalidated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The config for validating.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Validator</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pydantic.BaseModel">BaseModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validator class for the config.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optional</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pydantic.BaseModel">BaseModel</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Validator class for the config.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input config after being passed through the validator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.validation.list_convert_validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_convert_validator</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Wrapper to set kwargs for list_convert validator.</p>


    </div>

</div>



  </div>

    </div>

</div><h2 id="cdp">CDP</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.helpers.s3_utils" class="doc doc-heading">
            <code>rdsa_utils.cdp.helpers.s3_utils</code>


</h2>

    <div class="doc doc-contents first">

        <p>Utility functions for interacting with AWS S3.</p>
<p>To initialise a boto3 client for S3 and configure it with Ranger RAZ
and SSL certificate, you can use the following code snippet:</p>
<pre><code class="language-python">
import boto3
import raz_client

ssl_file_path = &quot;/path/to/your/ssl_certificate.crt&quot;

# Create a boto3 client for S3
client = boto3.client(&quot;s3&quot;)

# Configure the client with RAZ and SSL certificate
raz_client.configure_ranger_raz(client, ssl_file=ssl_file_path)

Note:
- The `raz-client` library is required only when running in a
  managed Cloudera environment.
- You can install it using `pip install raz-client` when needed.
</code></pre>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.check_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a file exists in an S3 bucket and meets specific criteria.</p>
<p>Verifies that the given path corresponds to a file in an S3 bucket,
ensuring it exists, is not a directory, and has a size greater than 0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a file in s3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists, is not a directory, and size &gt; 0,
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">check_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">check_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/nonexistent_file.txt&#39;</span><span class="p">)</span>
<span class="go">False</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">check_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/&#39;</span><span class="p">)</span>
<span class="go">False</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.copy_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Copy a file from one aWS S3 bucket to another.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the source bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the source file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the destination bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the destination file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the destination file if it already exists.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was copied successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source_file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destination-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destination_file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.create_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a folder in an AWS S3 bucket if it doesn't already exist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket where the folder will be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the folder to create.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was created successfully or
already exists, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_folder</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;new_folder/&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.delete_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a file from an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket from which the file will be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the file to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, the function will not delete the file if it does not exist;
set to True to ignore non-existence on delete.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was deleted successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/s3_file.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.delete_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a folder in an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the folder to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was deleted successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_folder</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;path/to/folder/&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.delete_old_objects_and_folders" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_old_objects_and_folders</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete objects and folders in an S3 bucket that are older than a specified age.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix to filter objects.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>age</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The age threshold for deleting objects. Supported formats:
- "1 day", "2 days", etc.
- "1 week", "2 weeks", etc.
- "1 month", "2 months", etc.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dry_run</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the function will only log the objects and folders
that would be deleted, without actually performing the deletion.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the objects and folders were (or would be)
deleted successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will actually delete objects:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_old_objects_and_folders</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/&#39;</span><span class="p">,</span> <span class="s1">&#39;1 week&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will only log the objects/folders to be deleted:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_old_objects_and_folders</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;1 week&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dry_run</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.download_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download a file from an AWS S3 bucket to a local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket from which to download the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the file to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local file path where the downloaded file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the local file if it exists.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was downloaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">download_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/s3_file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/download.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.download_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download a folder from an AWS S3 bucket to a local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket from which to download the folder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 prefix of the folder to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local directory path where the downloaded folder will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite existing local files if they exist.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was downloaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">download_folder</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/subfolder/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/local_folder&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.file_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_exists</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a specific file exists in an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to check for existence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_exists</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.file_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_size</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check the size of a file in an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to check for size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer value indicating the size of the file in bytes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_size</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">8</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.is_s3_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_s3_directory</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if an AWS S3 key is a directory by listing its contents.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the key represents a directory, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.list_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_files</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>List files in an AWS S3 bucket that match a specific prefix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix to filter files, by default "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of S3 object keys matching the prefix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_files</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder_prefix/&#39;</span><span class="p">)</span>
<span class="go">[&#39;folder_prefix/file1.txt&#39;, &#39;folder_prefix/file2.txt&#39;]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.load_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">keep_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rename_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">drop_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a CSV file from an S3 bucket into a Pandas DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key (full path and filename) of the CSV file in the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names to keep in the DataFrame, dropping all others.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rename_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary to rename columns where keys are existing column
names and values are new column names.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names to drop from the DataFrame.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the <code>pd.read_csv</code> method.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pandas DataFrame containing the data from the CSV file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidBucketNameError (rdsa_utils.exceptions.InvalidBucketNameError)" href="#rdsa_utils.exceptions.InvalidBucketNameError">InvalidBucketNameError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the bucket name does not meet AWS specifications.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidS3FilePathError (rdsa_utils.exceptions.InvalidS3FilePathError)" href="#rdsa_utils.exceptions.InvalidS3FilePathError">InvalidS3FilePathError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file_path contains an S3 URI scheme like 's3://' or 's3a://'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error loading the file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a column specified in rename_columns, drop_columns, or
keep_columns is not found in the DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Transformation order:
1. Columns are kept according to <code>keep_columns</code>.
2. Columns are dropped according to <code>drop_columns</code>.
3. Columns are renamed according to <code>rename_columns</code>.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Load a CSV file and rename columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span>
<span class="go">        client,</span>
<span class="go">        &quot;my-bucket&quot;,</span>
<span class="go">        &quot;path/to/file.csv&quot;,</span>
<span class="go">        rename_columns={&quot;old_name&quot;: &quot;new_name&quot;}</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a CSV file and keep only specific columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span>
<span class="go">        client,</span>
<span class="go">        &quot;my-bucket&quot;,</span>
<span class="go">        &quot;path/to/file.csv&quot;,</span>
<span class="go">        keep_columns=[&quot;col1&quot;, &quot;col2&quot;]</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a CSV file and drop specific columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span>
<span class="go">        client,</span>
<span class="go">        &quot;my-bucket&quot;,</span>
<span class="go">        &quot;path/to/file.csv&quot;,</span>
<span class="go">        drop_columns=[&quot;col1&quot;, &quot;col2&quot;]</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a CSV file with custom delimiter:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span>
<span class="go">        client,</span>
<span class="go">        &quot;my-bucket&quot;,</span>
<span class="go">        &quot;path/to/file.csv&quot;,</span>
<span class="go">        sep=&quot;;&quot;</span>
<span class="go">    )</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.load_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_json</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">multi_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a JSON file from an S3 bucket, with optional line-by-line parsing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key (full path and filename) of the JSON file in the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>encoding</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The encoding of the JSON file.</p>
              </div>
            </td>
            <td>
                  <code>&#39;utf-8&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multi_line</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, reads the JSON file line by line, treating each line as a
separate JSON object.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>If <code>multi_line=False</code>: A dictionary containing the parsed JSON data.</li>
<li>If <code>multi_line=True</code>: A list of dictionaries, each corresponding to
  a JSON object per line.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidBucketNameError (rdsa_utils.exceptions.InvalidBucketNameError)" href="#rdsa_utils.exceptions.InvalidBucketNameError">InvalidBucketNameError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the bucket name is invalid according to AWS rules.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error loading the file from S3 or parsing the JSON.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;path/to/file.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &quot;name&quot;: &quot;John&quot;,</span>
<span class="go">    &quot;age&quot;: 30,</span>
<span class="go">    &quot;city&quot;: &quot;Manchester&quot;</span>
<span class="go">}</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">log_data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;path/to/log.json&#39;</span><span class="p">,</span> <span class="n">multi_line</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">log_data</span><span class="p">)</span>
<span class="go">[{&#39;event&#39;: &#39;start&#39;, &#39;timestamp&#39;: &#39;2025-02-18T12:00:00Z&#39;}, ...]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.md5_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">md5_sum</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get md5 hash of a specific object on s3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to create md5 hash from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string value with the MD5 hash of the object data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">md5_sum</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.move_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Move a file within or between AWS S3 buckets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the source S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the source file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the destination S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name of the destination file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was moved successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;sourcebucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source_folder/file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destbucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;dest_folder/file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.read_header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_header</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read the first line of a file on s3.</p>
<p>Gets the entire file using boto3 get_objects, converts its body into
an input stream, reads the first line and remove the carriage return
character (backslash-n) from the end.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to read header from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the first line of the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">read_header</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">&quot;First line&quot;</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.remove_leading_slash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_leading_slash</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the leading forward slash from a string if present.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text from which the leading slash will be removed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text stripped of its leading slash.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">remove_leading_slash</span><span class="p">(</span><span class="s1">&#39;/example/path&#39;</span><span class="p">)</span>
<span class="go">&#39;example/path&#39;</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.s3_walk" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">s3_walk</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Traverse an S3 bucket and return its structure in a dictionary format.</p>
<p>Mimics the functionality of os.walk in s3 bucket using long filenames with slashes.
Recursively goes through the long filenames and splits it into subdirectories, and
"files" - short file names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix of the object to start the walk from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary representing the bucket structure where:
- Keys are directory paths ending with '/'
- Values are tuples of (set(subdirectories), set(files)) where:
  - subdirectories: a set of directory names ending with '/'
  - files: a set of file paths</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># For a bucket with files: file5.txt, folder1/file1.txt, folder1/file2.txt,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># folder1/subfolder1/file3.txt, and folder2/file4.txt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3_walk</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;test-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &#39;&#39;: ({&quot;folder1/&quot;, &quot;folder2/&quot;}, {&quot;file5.txt&quot;}),</span>
<span class="go">    &#39;folder1/&#39;: (set(), {&quot;folder1/&quot;}),</span>
<span class="go">    &#39;folder2/&#39;: (set(), {&quot;folder2/&quot;})</span>
<span class="go">}</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># When using a specific prefix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3_walk</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;test-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder1/&#39;</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &#39;folder1/&#39;: ({&quot;subfolder1/&quot;}, {&quot;folder1/file1.txt&quot;, &quot;folder1/file2.txt&quot;}),</span>
<span class="go">    &#39;folder1/subfolder1/&#39;: (set(), {&quot;folder1/subfolder1/&quot;})</span>
<span class="go">}</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Empty bucket or nonexistent prefix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3_walk</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;test-bucket&#39;</span><span class="p">,</span> <span class="s1">&#39;nonexistent/&#39;</span><span class="p">)</span>
<span class="go">{}</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.upload_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload a file to an Amazon S3 bucket from local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path on the local system to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target S3 object name. If None, uses the base name of
the local file path.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the existing file on S3 will be overwritten.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was uploaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upload_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/s3_file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.upload_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload an entire folder from the local file system to an AWS S3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket to which the folder will be uploaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the local folder to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix to prepend to each object name when uploading to S3.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite existing files in the bucket.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was uploaded successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upload_folder</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/local/folder&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder_prefix&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.validate_bucket_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_bucket_name</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate the format of an AWS S3 bucket name according to AWS rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated bucket name if valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidBucketNameError (rdsa_utils.exceptions.InvalidBucketNameError)" href="#rdsa_utils.exceptions.InvalidBucketNameError">InvalidBucketNameError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the bucket name does not meet AWS specifications.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_bucket_name</span><span class="p">(</span><span class="s1">&#39;valid-bucket-name&#39;</span><span class="p">)</span>
<span class="go">&#39;valid-bucket-name&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_bucket_name</span><span class="p">(</span><span class="s1">&#39;Invalid_Bucket_Name&#39;</span><span class="p">)</span>
<span class="go">InvalidBucketNameError: Bucket name must not contain underscores.</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.validate_s3_file_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_s3_file_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_s3_scheme</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate the file path based on the S3 URI scheme.</p>
<p>If <code>allow_s3_scheme</code> is True, the file path must contain an S3 URI scheme
(either 's3://' or 's3a://').</p>
<p>If <code>allow_s3_scheme</code> is False, the file path should not contain an S3 URI scheme.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_s3_scheme</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to allow an S3 URI scheme in the file path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated file path if valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidS3FilePathError (rdsa_utils.exceptions.InvalidS3FilePathError)" href="#rdsa_utils.exceptions.InvalidS3FilePathError">InvalidS3FilePathError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the validation fails based on the value of <code>allow_s3_scheme</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_s3_file_path</span><span class="p">(</span><span class="s1">&#39;data_folder/data.csv&#39;</span><span class="p">,</span> <span class="n">allow_s3_scheme</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;data_folder/data.csv&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_s3_file_path</span><span class="p">(</span><span class="s1">&#39;s3a://bucket-name/data.csv&#39;</span><span class="p">,</span> <span class="n">allow_s3_scheme</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;s3a://bucket-name/data.csv&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_s3_file_path</span><span class="p">(</span><span class="s1">&#39;s3a://bucket-name/data.csv&#39;</span><span class="p">,</span> <span class="n">allow_s3_scheme</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">InvalidS3FilePathError: The file_path should not contain an S3 URI scheme</span>
<span class="go">like &#39;s3://&#39; or &#39;s3a://&#39;.</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.write_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_csv</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a Pandas Dataframe to csv in an S3 bucket.</p>
<p>Uses StringIO library as a RAM buffer, so at first Pandas writes data to the
buffer, then the buffer returns to the beginning, and then it is sent to
the S3 bucket using the boto3.put_object method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to write to the specified path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filepath to save the dataframe to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of Pandas to_csv arguments.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the dataframe is written successfully.
False if it was not possible to serialise or write the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error writing the file to S3.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_csv</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;path/to/file.csv&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.write_excel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_excel</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a Pandas DataFrame to an Excel file in an S3 bucket.</p>
<p>Uses BytesIO as a RAM buffer. Pandas writes data to the buffer,
the buffer rewinds to the beginning, and then it is sent to S3
using the boto3.put_object method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to write to the specified path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filepath to save the dataframe to in the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional dictionary of Pandas <code>to_excel</code> arguments.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the dataframe is written successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error writing the file to S3.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_excel</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;my_bucket&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;path/to/file.xlsx&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.write_string_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_string_to_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a string into the specified object in the s3 bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The S3 object name to write into.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_content</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The content (str) to be written to "object_name".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The outcome of this operation is the string written
into the object in the s3 bucket. It will overwrite
anything in the object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_string_to_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;example content&#39;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.zip_local_directory_to_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zip_local_directory_to_s3</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">local_directory_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Zips a local directory and uploads it to AWS S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_directory_path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the local directory to be zipped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 key (path) where the zip file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, will not upload if the file already exists in S3.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if upload was successful, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zip_local_directory_to_s3</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/local/dir&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;backups/mydir.zip&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With overwrite parameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zip_local_directory_to_s3</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/local/dir&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s1">&#39;my-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;backups/mydir.zip&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.s3_utils.zip_s3_directory_to_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zip_s3_directory_to_s3</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Zips a directory that exists in S3 and saves it to another location in S3.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initialised boto3 S3 client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the source S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefix (directory path) in the source bucket to zip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the destination S3 bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 key (path) where the zip file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, will not upload if the file already exists.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if operation was successful, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">boto3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zip_s3_directory_to_s3</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;data/logs/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;dest-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;archives/logs.zip&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># With overwrite parameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zip_s3_directory_to_s3</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">s3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;data/logs/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;dest-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;archives/logs.zip&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.helpers.hdfs_utils" class="doc doc-heading">
            <code>rdsa_utils.cdp.helpers.hdfs_utils</code>


</h2>

    <div class="doc doc-contents first">

        <p>Utility functions for interacting with HDFS.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.change_permissions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">change_permissions</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">permission</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Change directory and file permissions in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file or directory in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>permission</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The permission to be set, e.g., 'go+rwx' or '777'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recursive</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, changes permissions for all subdirectories and
files within a directory.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation was successful (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Copy a file in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source path of the file in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target path of the file in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the existing file at the target path will be overwritten,
default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation was successful (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="subprocess.TimeoutExpired">TimeoutExpired</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the process does not complete within the default timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.copy_local_to_hdfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_local_to_hdfs</span><span class="p">(</span><span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Copy a local file to HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the local file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the HDFS directory where the file will be copied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation was successful (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.create_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_dir</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a directory in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HDFS path where the directory should be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation is successful (directory created),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.create_txt_from_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_txt_from_string</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">string_to_write</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">replace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create and populate a text file in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the new file to be created, for example,
'/some/directory/newfile.txt'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>string_to_write</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string that will populate the new text file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>replace</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag determining whether an existing file should be replaced.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function doesn't return anything; it's used for its side effect
of creating a text file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>replace</code> is False and the file already exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.delete_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_dir</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete an empty directory from HDFS.</p>
<p>This function attempts to delete an empty directory in HDFS.
If the directory is not empty, the deletion will fail.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HDFS path to the directory to be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation is successful (directory deleted),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function will only succeed if the directory is empty.
To delete directories containing files or other directories,
consider using <code>delete_path</code> instead.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.delete_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a specific file in HDFS.</p>
<p>This function is used to delete a single file located
at the specified HDFS path. If the path points to a
directory, the command will fail.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file in HDFS to be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was successfully deleted (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="subprocess.TimeoutExpired">TimeoutExpired</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the process does not complete within the default timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function is intended for files only. For directory deletions,
use <code>delete_dir</code> or <code>delete_path</code>.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.delete_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_path</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a file or directory in HDFS, including non-empty directories.</p>
<p>This function is capable of deleting both files and directories.
When applied to directories, it will recursively delete all contents
within the directory, making it suitable for removing directories regardless
of whether they are empty or contain files or other directories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file or directory in HDFS to be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was successfully deleted (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="subprocess.TimeoutExpired">TimeoutExpired</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the process does not complete within the default timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="warning" open>
  <summary>Warning</summary>
  <p>Use with caution: applying this function to a directory will
remove all contained files and subdirectories without confirmation.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.file_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_exists</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check whether a file exists in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file in HDFS to be checked for existence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists (command return code 0), otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="subprocess.TimeoutExpired">TimeoutExpired</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the process does not complete within the default timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.get_date_modified" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_date_modified</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the last modified date of a file in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The date the file was last modified.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.is_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_dir</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Test if a directory exists in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HDFS path to the directory to be tested.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation is successful (directory exists), otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.move_local_to_hdfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_local_to_hdfs</span><span class="p">(</span><span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Move a local file to HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the local file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the HDFS directory where the file will be moved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation was successful (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.read_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_dir</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read the contents of a directory in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the directory in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of full paths of the items found in the directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.read_dir_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_dir_files</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read the filenames in a directory in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the directory in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of filenames in the directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.read_dir_files_recursive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_dir_files_recursive</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">return_path</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Recursively reads the contents of a directory in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the directory in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_path</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns the full path of the files, otherwise
just the filename.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of files in the directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.hdfs_utils.rename" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rename</span><span class="p">(</span><span class="n">from_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rename (i.e., move using full path) a file in HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>from_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source path of the file in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>to_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target path of the file in HDFS.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the existing file at the target path will be overwritten,
default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the operation was successful (command return code 0),
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="subprocess.TimeoutExpired">TimeoutExpired</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the process does not complete within the default timeout.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.helpers.impala" class="doc doc-heading">
            <code>rdsa_utils.cdp.helpers.impala</code>


</h2>

    <div class="doc doc-contents first">

        <p>Utilities for working with Impala.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.helpers.impala.invalidate_impala_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invalidate_impala_metadata</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">impalad_address_port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">impalad_ca_cert</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">keep_stderr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Automate the invalidation of a table's metadata using impala-shell.</p>
<p>This function uses the impala-shell command with the given
impalad_address_port and impalad_ca_cert, to invalidate a specified
table's metadata.</p>
<p>It proves useful during a data pipeline's execution after writing to an
intermediate Hive table. Using Impala Query Editor in Hue, end-users often
need to run "INVALIDATE METADATA" command to refresh a table's metadata.
However, this manual step can be missed, leading to potential use of
outdated metadata.</p>
<p>The function automates the "INVALIDATE METADATA" command for a given table,
ensuring up-to-date metadata for future queries. This reduces manual
intervention, making outdated metadata issues less likely to occur.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table for metadata invalidation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impalad_address_port</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>'address:port' of the impalad instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>impalad_ca_cert</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to impalad's CA certificate file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep_stderr</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, will print impala-shell command's stderr output.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">invalidate_impala_metadata</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;my_table&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;localhost:21050&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/ca_cert.pem&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invalidate_impala_metadata</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;my_table&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;localhost:21050&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/ca_cert.pem&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">keep_stderr</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.io.pipeline_runlog" class="doc doc-heading">
            <code>rdsa_utils.cdp.io.pipeline_runlog</code>


</h2>

    <div class="doc doc-contents first">

        <p>Utilities for managing a Pipeline Runlog using Hive Tables.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.add_runlog_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_runlog_entry</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ConfigParser</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pipeline_runlog&#39;</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an entry to a target runlog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>desc</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description to attach to the log entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of the pipeline.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="configparser.ConfigParser">ConfigParser</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object for the run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pipeline</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pipeline name. If None, uses the spark application name.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target runlog table. If database not set, this should
include the database.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pipeline_runlog&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run id to use if already reserved. If not specified,
a new one is generated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The log entry returned as a spark dataframe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.create_runlog_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_runlog_entry</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">desc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ConfigParser</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create an entry for the runlog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Entry run id.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>desc</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description to attach to the log entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of the pipeline.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="configparser.ConfigParser">ConfigParser</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object for the run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pipeline</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pipeline name. If None, derives from spark app name.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The log entry returned as a spark dataframe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.create_runlog_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_runlog_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tablename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pipeline_runlog&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create runlog and _reserved_ids tables in the target database if needed.</p>
<p>This function executes two SQL queries to create two tables, if they do
not already exist in the target database. The first table's structure
includes columns for run_id, desc, user, datetime, pipeline_name,
pipeline_version, and config, while the second table includes run_id and
reserved_date.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running spark session which will be used to execute SQL queries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target database where tables will be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tablename</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the main table to be created (default is "pipeline_runlog").
The associated _reserved_ids table will be suffixed with this name.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pipeline_runlog&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;test_session&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_runlog_table</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;test_db&quot;</span><span class="p">,</span> <span class="s2">&quot;test_table&quot;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.get_last_run_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_last_run_id</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pipeline_runlog&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve the last run_id, either in general or for a specific pipeline.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running Spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pipeline</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, the result will be for the listed pipeline only.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target runlog table. If the database is not set, this should
include the database.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pipeline_runlog&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the last run. Returns None if the log table is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.get_penultimate_run_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_penultimate_run_id</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log_table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pipeline_runlog&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve penultimate run_id in general or a specific pipeline.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running Spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pipeline</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, the result will be for the listed pipeline only.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target runlog table. If the database is not set, this should
include the database.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pipeline_runlog&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the penultimate run. Returns None if the log table is empty
or has less than two entries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.reserve_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reserve_id</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">log_table</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pipeline_runlog&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reserve a run id in the reserved ids table linked to the runlog table.</p>
<p>The function reads the last run id from the reserved ids table,
increments it to create a new id,and writes the new id with the
current timestamp to the reserved ids table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running SparkSession instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>log_table</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the main pipeline runlog table associated with
this reserved id table, by default "pipeline_runlog".</p>
              </div>
            </td>
            <td>
                  <code>&#39;pipeline_runlog&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new run id.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.pipeline_runlog.write_runlog_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_runlog_file</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">runlog_table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">runlog_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write metadata from runlog entry to a text file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A running SparkSession instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runlog_table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table containing the runlog entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runlog_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The id of the desired entry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The HDFS path where the file will be written.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function doesn't return anything; it's used for its
side effect of creating a text file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.io.input" class="doc doc-heading">
            <code>rdsa_utils.cdp.io.input</code>


</h2>

    <div class="doc doc-contents first">

        <p>Read inputs on CDP.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.input.extract_database_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extract_database_name</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">long_table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract the database component and table name from a compound table name.</p>
<p>This function can handle multiple scenarios:</p>
<ol>
<li>
<p>For GCP's naming format '<project>.<database>.<table>',
   the function will return the database and table name.</p>
</li>
<li>
<p>If the name is formatted as 'db_name.table_name', the function will
   extract and return the database and table names.</p>
</li>
<li>
<p>If the long_table_name contains only the table name (e.g., 'table_name'),
   the function will use the current database of the SparkSession.</p>
</li>
<li>
<p>For any other incorrectly formatted names, the function will raise
   a ValueError.</p>
</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>long_table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Full name of the table, which can include the GCP project
and/or database name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the name of the database and the table name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the table name doesn't match any of the expected formats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.input.get_current_database" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_current_database</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve the current database from the active SparkSession.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.input.get_tables_in_database" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tables_in_database</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">database_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of tables in a given database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the database from which to list tables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of table names in the specified database.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error fetching tables from the specified database.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">tables</span> <span class="o">=</span> <span class="n">get_tables_in_database</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>
<span class="go">[&#39;table1&#39;, &#39;table2&#39;, &#39;table3&#39;]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.input.load_and_validate_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_and_validate_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">skip_validation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">err_msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">filter_cond</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keep_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rename_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">drop_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a table, apply transformations, and validate if it is not empty.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table to load.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_validation</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skips validation step, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>err_msg</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error message to return if table is empty, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_cond</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Condition to apply to SparkDF once read, by default None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names to keep in the DataFrame, dropping all others.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rename_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary to rename columns where keys are existing column
names and values are new column names.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>drop_columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of column names to drop from the DataFrame.
Default value is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loaded SparkDF if validated, subject to options above.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="PermissionError">PermissionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there's an issue accessing the table or if the table
does not exist in the specified database.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the table is empty after loading, becomes empty after applying
a filter condition, or if columns specified in keep_columns,
drop_columns, or rename_columns do not exist in the DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Transformation order:
1. Columns are kept according to <code>keep_columns</code>.
2. Columns are dropped according to <code>drop_columns</code>.
3. Columns are renamed according to <code>rename_columns</code>.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Load a table, apply a filter, and validate it:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_and_validate_table</span><span class="p">(</span>
<span class="go">        spark=spark,</span>
<span class="go">        table_name=&quot;my_table&quot;,</span>
<span class="go">        filter_cond=&quot;age &gt; 21&quot;</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a table and keep only specific columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_and_validate_table</span><span class="p">(</span>
<span class="go">        spark=spark,</span>
<span class="go">        table_name=&quot;my_table&quot;,</span>
<span class="go">        keep_columns=[&quot;name&quot;, &quot;age&quot;, &quot;city&quot;]</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a table, drop specific columns, and rename a column:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_and_validate_table</span><span class="p">(</span>
<span class="go">        spark=spark,</span>
<span class="go">        table_name=&quot;my_table&quot;,</span>
<span class="go">        drop_columns=[&quot;extra_column&quot;],</span>
<span class="go">        rename_columns={&quot;name&quot;: &quot;full_name&quot;}</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a table, skip validation, and apply all transformations:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_and_validate_table</span><span class="p">(</span>
<span class="go">        spark=spark,</span>
<span class="go">        table_name=&quot;my_table&quot;,</span>
<span class="go">        skip_validation=True,</span>
<span class="go">        keep_columns=[&quot;name&quot;, &quot;age&quot;, &quot;city&quot;],</span>
<span class="go">        drop_columns=[&quot;extra_column&quot;],</span>
<span class="go">        rename_columns={&quot;name&quot;: &quot;full_name&quot;},</span>
<span class="go">        filter_cond=&quot;age &gt; 21&quot;</span>
<span class="go">    )</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.cdp.io.output" class="doc doc-heading">
            <code>rdsa_utils.cdp.io.output</code>


</h2>

    <div class="doc doc-contents first">

        <p>Write outputs on CDP.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.output.insert_df_to_hive_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">insert_df_to_hive_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fill_missing_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">repartition_data_by</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write SparkDF to Hive table with optional configuration.</p>
<p>This function writes data from a SparkDF into a Hive table, handling missing
columns and optional repartitioning. It ensures the table's column order matches
the DataFrame and manages different overwrite behaviors for partitioned and
non-partitioned data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SparkDF containing data to be written.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the Hive table to write data into.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Controls how existing data is handled, default is False:</p>
<p>For non-partitioned data:
- True: Replaces entire table with DataFrame data.
- False: Appends DataFrame data to existing table.</p>
<p>For partitioned data:
- True: Replaces data only in partitions present in DataFrame.
- False: Appends data to existing partitions or creates new ones.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_missing_cols</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, adds missing columns as NULL values. If False, raises an error
on schema mismatch, default is False.</p>
<ul>
<li>Explicitly casts DataFrame columns to match the Hive table schema to
  avoid type mismatch errors.</li>
<li>Adds missing columns as NULL values when <code>fill_missing_cols</code> is True,
  regardless of their data type (e.g., String, Integer, Double, Boolean, etc.).</li>
</ul>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>repartition_data_by</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Controls data repartitioning, default is None:
- int: Sets target number of partitions.
- str: Specifies column to repartition by.
- None: No repartitioning performed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>When using repartition with a number:
- Affects physical file structure but preserves Hive partitioning scheme.
- Controls number of output files per write operation per Hive partition.
- Maintains partition-based query optimisation.</p>
<p>When repartitioning by column:
- Helps balance file sizes across Hive partitions.
- Reduces creation of small files.</p>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.utils.AnalysisException">AnalysisException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there's an error reading the table. This can occur if the table
doesn't exist or if there's no access to it.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the SparkDF schema does not match the Hive table schema and
'fill_missing_cols' is set to False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DataframeEmptyError (rdsa_utils.exceptions.DataframeEmptyError)" href="#rdsa_utils.exceptions.DataframeEmptyError">DataframeEmptyError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input DataFrame is empty.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For other general exceptions when writing data to the table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Write a DataFrame to a Hive table without overwriting:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">insert_df_to_hive_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spark</span><span class="o">=</span><span class="n">spark</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;my_database.my_table&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Overwrite an existing table with a DataFrame:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">insert_df_to_hive_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spark</span><span class="o">=</span><span class="n">spark</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Write a DataFrame to a Hive table with missing columns filled:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">insert_df_to_hive_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spark</span><span class="o">=</span><span class="n">spark</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fill_missing_cols</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Repartition by column before writing to Hive:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">insert_df_to_hive_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spark</span><span class="o">=</span><span class="n">spark</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">repartition_data_by</span><span class="o">=</span><span class="s2">&quot;partition_column&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>
    <p>Repartition into a fixed number of partitions before writing:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">insert_df_to_hive_table</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">spark</span><span class="o">=</span><span class="n">spark</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;my_database.my_table&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">repartition_data_by</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.output.save_csv_to_hdfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_csv_to_hdfs</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Save DataFrame as CSV on HDFS, coalescing to a single partition.</p>
<p>This function saves a PySpark DataFrame to HDFS in CSV format. By
coalescing the DataFrame into a single partition before saving, it
accomplishes two main objectives:</p>
<ol>
<li>
<p>Single Part File: The output is a single CSV file rather than
   multiple part files. This method reduces complexity and
   cuts through the clutter of multi-part files, offering users
   and systems a more cohesive and hassle-free experience.</p>
</li>
<li>
<p>Preserving Row Order: Coalescing into a single partition maintains
   the order of rows as they appear in the DataFrame. This is essential
   when the row order matters for subsequent processing or analysis.
   It's important to note, however, that coalescing can have performance
   implications for very large DataFrames by concentrating
   all data processing on a single node.</p>
</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PySpark DataFrame to be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the CSV file. Must include the ".csv" extension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>HDFS path where the CSV file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite any existing file with the same name. If False
and the file exists, the function will raise an error.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file_name does not end with ".csv".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="IOError">IOError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If overwrite is False and the target file already exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Saving to an S3 bucket using the <code>s3a://</code> scheme:</p>
<pre><code class="language-python"># Assume `df` is a pre-defined PySpark DataFrame
file_name = &quot;data_output.csv&quot;
file_path = &quot;s3a://my-bucket/data_folder/&quot;
save_csv_to_hdfs(df, file_name, file_path, overwrite=True)
</code></pre>
<p>Saving to a normal HDFS path:</p>
<pre><code class="language-python"># Assume `df` is a pre-defined PySpark DataFrame
file_name = &quot;data_output.csv&quot;
file_path = &quot;/user/hdfs/data_folder/&quot;
save_csv_to_hdfs(df, file_name, file_path, overwrite=True)
</code></pre>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.output.save_csv_to_s3" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_csv_to_s3</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">s3_client</span><span class="p">:</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Save DataFrame as CSV on S3, coalescing to a single partition.</p>
<p>This function saves a PySpark DataFrame to S3 in CSV format. By
coalescing the DataFrame into a single partition before saving, it
accomplishes two main objectives:</p>
<ol>
<li>
<p>Single Part File: The output is a single CSV file rather than
   multiple part files. This method reduces complexity and
   cuts through the clutter of multi-part files, offering users
   and systems a more cohesive and hassle-free experience.</p>
</li>
<li>
<p>Preserving Row Order: Coalescing into a single partition maintains
   the order of rows as they appear in the DataFrame. This is essential
   when the row order matters for subsequent processing or analysis.
   It's important to note, however, that coalescing can have performance
   implications for very large DataFrames by concentrating
   all data processing on a single node.</p>
</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PySpark DataFrame to be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the S3 bucket where the CSV file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the CSV file. Must include the ".csv" extension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 path where the CSV file should be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s3_client</code>
            </td>
            <td>
                  <code><span title="boto3.client">client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boto3 S3 client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite any existing file with the same name. If False
and the file exists, the function will raise an error.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file_name does not end with ".csv".</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="InvalidBucketNameError">InvalidBucketNameError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the bucket name does not meet AWS specifications.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="InvalidS3FilePathError">InvalidS3FilePathError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file_path contains an S3 URI scheme like 's3://' or 's3a://'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="IOError">IOError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If overwrite is False and the target file already exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Saving to an S3 bucket:</p>
<pre><code class="language-python"># Assume `df` is a pre-defined PySpark DataFrame
file_name = &quot;data_output.csv&quot;
file_path = &quot;data_folder/&quot;
s3_client = boto3.client('s3')
save_csv_to_s3(
    df,
    'my-bucket',
    file_name,
    file_path,
    s3_client,
    overwrite=True
)
</code></pre>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.cdp.io.output.write_and_read_hive_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_and_read_hive_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">filter_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;run_id&#39;</span><span class="p">,</span> <span class="n">fill_missing_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a SparkDF to an existing Hive table and then read it back.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF to be written to the Hive table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Hive table to write to and read from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Hive database name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_id</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The identifier to filter on when reading data back from the Hive table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column name to use for filtering data when reading back from
the Hive table, by default 'run_id'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;run_id&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_missing_cols</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, missing columns in the DataFrame will be filled with nulls
when writing to the Hive table, by default False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DataFrame read from the Hive table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified Hive table does not exist in the given database or
if the provided DataFrame doesn't contain the specified filter column.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For general exceptions encountered during execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>This function assumes the Hive table already exists. The DataFrame <code>df</code>
should have the same schema as the Hive table for the write to succeed.</p>
<p>The function allows for more effective memory management when dealing
with large PySpark DataFrames by leveraging Hive's on-disk storage.</p>
<p>Predicate pushdown is used when reading the data back into a PySpark
DataFrame, minimizing the memory usage and optimising the read
operation.</p>
<p>As part of the design, there is always a column called filter_col in the
DataFrame and Hive table to track pipeline runs.</p>
<p>The Hive table contains all the runs, and we only read back the run that we
just wrote to the Hive Table using the <code>filter_id</code> parameter. If no
<code>filter_col</code> is specified, 'run_id' is used as default.</p>
</details>

    </div>

</div>



  </div>

    </div>

</div><h2 id="gcp">GCP</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.gcp.helpers.gcp_utils" class="doc doc-heading">
            <code>rdsa_utils.gcp.helpers.gcp_utils</code>


</h2>

    <div class="doc doc-contents first">

        <p>Utility functions for interacting with Google Cloud Storage.</p>
<p>To initialise a client for GCS and configure it with a service account
JSON key file, you can use the following code snippet:</p>
<pre><code class="language-python">from google.cloud import storage

# Create a GCS client
client = storage.Client.from_service_account_json('path/to/keyfile.json')
</code></pre>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.copy_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Copy a file from one GCS bucket to another.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the source bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the source file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the destination bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the destination file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the destination file if it already exists.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was copied successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source_file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destination-bucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destination_file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.create_folder_on_gcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_folder_on_gcs</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a folder in a GCS bucket if it doesn't already exist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket where the folder will be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the folder to create.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was created successfully or
already exists, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">create_folder_on_gcs</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;new_folder/&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.delete_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a file from a GCS bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket from which the file will be deleted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the file to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was deleted successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_file</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/gcs_file.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.delete_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete a folder in a GCS bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the GCS bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>folder_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the folder to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was deleted successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_folder</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;path/to/folder/&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.download_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download a file from a GCS bucket to a local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the GCS bucket from which to download the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the file to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local file path where the downloaded file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the local file if it exists.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was downloaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">download_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/gcs_file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/download.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.download_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">download_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Download a folder from a GCS bucket to a local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the GCS bucket from which to download the folder.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS prefix of the folder to download.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The local directory path where the downloaded folder will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite existing local files if they exist.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was downloaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">download_folder</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/subfolder/&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/local_folder&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.file_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_exists</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a specific file exists in a GCS bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name to check for existence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_exists</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder/file.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.get_table_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_table_columns</span><span class="p">(</span><span class="n">table_path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the column names for given bigquery table.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.is_gcs_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_gcs_directory</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a GCS key is a directory by listing its contents.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the GCS bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the key represents a directory, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.list_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_files</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>List files in a GCS bucket that match a specific prefix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix to filter files, by default "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of GCS object keys matching the prefix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_files</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span> <span class="s1">&#39;folder_prefix/&#39;</span><span class="p">)</span>
<span class="go">[&#39;folder_prefix/file1.txt&#39;, &#39;folder_prefix/file2.txt&#39;]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.load_config_gcp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_config_gcp</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load the config and dev_config files to dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the config file in a yaml format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Dict">Dict</span>, <span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contents of the config files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.move_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">source_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">destination_object_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Move a file within or between GCS buckets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the source GCS bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the source file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the destination GCS bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination_object_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS object name of the destination file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was moved successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">move_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;sourcebucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;source_folder/file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;destbucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;dest_folder/file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.remove_leading_slash" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_leading_slash</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove the leading forward slash from a string if present.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text from which the leading slash will be removed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The text stripped of its leading slash.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">remove_leading_slash</span><span class="p">(</span><span class="s1">&#39;/example/path&#39;</span><span class="p">)</span>
<span class="go">&#39;example/path&#39;</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.run_bq_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_bq_query</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">QueryJob</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run an SQL query in BigQuery.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.table_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">table_exists</span><span class="p">(</span><span class="n">table_path</span><span class="p">:</span> <span class="n">TablePath</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check the big query catalogue to see if a table exists.</p>
<p>Returns True if a table exists.
See code sample explanation here:
https://cloud.google.com/bigquery/docs/samples/bigquery-table-exists#bigquery_table_exists-python</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_path</code>
            </td>
            <td>
                  <code><span title="rdsa_utils.typing.TablePath">TablePath</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target BigQuery table name of form:
<project_id>.<database>.<table_name></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns True if table exists and False if table does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.upload_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_file</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">object_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload a file to a GCS bucket from local directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target GCS bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path on the local system to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>object_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target GCS object name. If None, uses the base name of
the local file path.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the existing file on GCS will be overwritten.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file was uploaded successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upload_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/file.txt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder/gcs_file.txt&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.upload_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upload_folder</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">local_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Upload an entire folder from the local file system to a GCS bucket.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>client</code>
            </td>
            <td>
                  <code><span title="google.cloud.storage.Client">Client</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The GCS client instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket to which the folder will be uploaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>local_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the local folder to upload.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix to prepend to each object name when uploading to GCS.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite existing files in the bucket.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the folder was uploaded successfully, otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">upload_folder</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">client</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;mybucket&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;/path/to/local/folder&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;folder_prefix&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.helpers.gcp_utils.validate_bucket_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_bucket_name</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate the format of a GCS bucket name according to GCS rules.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bucket_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the bucket to validate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated bucket name if valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="InvalidBucketNameError (rdsa_utils.exceptions.InvalidBucketNameError)" href="#rdsa_utils.exceptions.InvalidBucketNameError">InvalidBucketNameError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the bucket name does not meet GCS specifications.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_bucket_name</span><span class="p">(</span><span class="s1">&#39;valid-bucket-name&#39;</span><span class="p">)</span>
<span class="go">&#39;valid-bucket-name&#39;</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">validate_bucket_name</span><span class="p">(</span><span class="s1">&#39;Invalid_Bucket_Name&#39;</span><span class="p">)</span>
<span class="go">InvalidBucketNameError: Bucket name must not contain underscores.</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.gcp.io.inputs" class="doc doc-heading">
            <code>rdsa_utils.gcp.io.inputs</code>


</h2>

    <div class="doc doc-contents first">

        <p>Read from BigQuery.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.io.inputs.build_sql_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_sql_query</span><span class="p">(</span><span class="n">table_path</span><span class="p">:</span> <span class="n">TablePath</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">column_filter_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create SQL query to load data with the specified filter conditions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_path</code>
            </td>
            <td>
                  <code><span title="rdsa_utils.typing.TablePath">TablePath</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BigQuery table path in format "database_name.table_name".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column selection. Selects all columns if None passed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_column</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to be used to filter the date range on.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_range</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence with two values, a lower and upper value for dates to load in.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_filter_dict</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing column: [values] where the values correspond to
terms in the column that are to be filtered by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_column</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column that the table is partitioned by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unit of time the table is partitioned by, must be one of:
    * <code>hour</code>
    * <code>day</code>
    * <code>month</code>
    * <code>year</code></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_value</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value or pair of values for filtering the partition column to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The string containing the SQL query.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.io.inputs.read_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">table_path</span><span class="p">:</span> <span class="n">TablePath</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">date_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">column_filter_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;run_id&#39;</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">flatten_struct_cols</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">partition_column</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BigQueryTimePartitions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read BigQuery table given table path and column selection.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spark session.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_path</code>
            </td>
            <td>
                  <code><span title="rdsa_utils.typing.TablePath">TablePath</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target BigQuery table name of form:
<project_id>.<database>.<table_name></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>columns</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column selection. Selects all columns if None passed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_column</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to be used to filter the date range on.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_range</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence with two values, a lower and upper value for dates to load in.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_filter_dict</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing column: [values] where the values correspond to
terms in the column that are to be filtered by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id_column</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to be used to filter to the specified run_id.</p>
              </div>
            </td>
            <td>
                  <code>&#39;run_id&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unique identifier for a run within the table that the read data is
filtered to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_column</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column that the table is partitioned by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="rdsa_utils.typing.BigQueryTimePartitions">BigQueryTimePartitions</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unit of time the table is partitioned by, must be one of:
    * <code>hour</code>
    * <code>day</code>
    * <code>month</code>
    * <code>year</code></p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_value</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value or pair of values for filtering the partition column to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flatten_struct_cols</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When true, any struct type columns in the loaded dataframe are replaced
with individual columns for each of the fields in the structs.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.gcp.io.outputs" class="doc doc-heading">
            <code>rdsa_utils.gcp.io.outputs</code>


</h2>

    <div class="doc doc-contents first">

        <p>Write outputs to GCP.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.gcp.io.outputs.write_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_table</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PandasDF</span><span class="p">,</span> <span class="n">SparkDF</span><span class="p">],</span> <span class="n">table_name</span><span class="p">:</span> <span class="n">TablePath</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;append&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;overwrite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="n">partition_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BigQueryTimePartitions</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">partition_expiry_days</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">clustered_fields</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write dataframe out to a Google BigQuery table.</p>
<p>In the case the table already exists, behavior of this function depends on
the save mode, specified by the mode function (default to throwing an
exception). When mode is Overwrite, the schema of the DataFrame does not
need to be the same as that of the existing table (the column order
doesn't need be the same).</p>
<p>If you use the <code>df.printSchema()</code> method directly in a print/log statement
the code is processed and printed regardless of logging level. Instead you
need to capture the output and pass this to the logger. See explanation
here - https://stackoverflow.com/a/59935109</p>
<p>To learn more about the partitioning of tables and how to use them in
BigQuery: https://cloud.google.com/bigquery/docs/partitioned-tables</p>
<p>To learn more about the clustering of tables and how to use them in
BigQuery: https://cloud.google.com/bigquery/docs/clustered-tables</p>
<p>To learn more about how spark dataframes are saved to BigQuery:
https://github.com/GoogleCloudDataproc/spark-bigquery-connector/blob/master/README.md</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="pandas.DataFrame">DataFrame</span>, <span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe to be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_name</code>
            </td>
            <td>
                  <code><span title="rdsa_utils.typing.TablePath">TablePath</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target BigQuery table name of form:
<project_id>.<database>.<table_name></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;append&#39;, &#39;error&#39;, &#39;ignore&#39;, &#39;overwrite&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite or append to the BigQuery table.
    * <code>append</code>: Append contents of this :class:<code>DataFrame</code> to table.
    * <code>overwrite</code>: Overwrite existing data.
    * <code>error</code>: Throw exception if data already exists.
    * <code>ignore</code>: Silently ignore this operation if data already exists.</p>
              </div>
            </td>
            <td>
                  <code>&#39;error&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_col</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A date or timestamp type column in the dataframe to use for the table
partitioning.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="rdsa_utils.typing.BigQueryTimePartitions">BigQueryTimePartitions</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The unit of time to partition the table by, must be one of:
    * <code>hour</code>
    * <code>day</code>
    * <code>month</code>
    * <code>year</code></p>
<p>If <code>partition_col</code> is specified and <code>partition_type = None</code> then
BigQuery will default to using <code>day</code> partition type.</p>
<p>If 'partition_type<code>is specified and</code>partition_col = None<code>then the
table will be partitioned by the ingestion time pseudo column, and can
be referenced in BigQuery via either</code>_PARTITIONTIME as pt<code>or</code>_PARTITIONDATE' as pd`.</p>
<p>See https://cloud.google.com/bigquery/docs/querying-partitioned-tables
for more information on querying partitioned tables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>partition_expiry_days</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, this is the number of days (any decimal values are
converted to that proportion of a day) that BigQuery keeps the data
in each partition.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clustered_fields</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, the columns (up to four) in the dataframe to cluster the
data by when outputting. The order the columns are specified is
important as will be the ordering of the clustering on the BigQuery
table.</p>
<p>See: https://cloud.google.com/bigquery/docs/querying-clustered-tables
for more information on querying clustered tables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div><h2 id="helpers">Helpers</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.helpers.pyspark" class="doc doc-heading">
            <code>rdsa_utils.helpers.pyspark</code>


</h2>

    <div class="doc doc-contents first">

        <p>A selection of helper functions for building in pyspark.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.aggregate_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_col</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Aggregate (sum, max, min, or mean) a numeric PySpark column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame containing the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the numeric column to aggregate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of aggregation to perform. Must be one of 'sum', 'max',
'min', or 'mean'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the specified aggregation on the column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.apply_col_func" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_col_func</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">SparkDF</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">SparkDF</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply a function to a list of columns in a PySpark DataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to apply the function to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span>[[<span title="pyspark.sql.DataFrame">DataFrame</span>, <span title="str">str</span>], <span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function to apply, which should accept two arguments: (df, col).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF after applying the function to each column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.cache_time_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cache_time_df</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cache a PySpark DataFrame and print the time taken to cache and count it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to cache.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.calc_median_price" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calc_median_price</span><span class="p">(</span><span class="n">groups</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">price_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the median price per grouping level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>groups</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grouping levels for calculating the average price.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>price_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name containing the product prices.</p>
              </div>
            </td>
            <td>
                  <code>&#39;price&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single entry for each grouping level, and its median price.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.convert_cols_to_struct_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_cols_to_struct_col</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">struct_col_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">struct_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">no_struct_col_type</span><span class="p">:</span> <span class="n">T</span><span class="o">.</span><span class="n">DataTypeSingleton</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">BooleanType</span><span class="p">(),</span> <span class="n">no_struct_col_value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert specified selection of columns to a single struct column.</p>
<p>As BigQuery tables do not take to having an empty struct column appended to
them, this function will create a placeholder column to put into the struct
column if no column names to combine are passed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input dataframe that contains the columns for combining.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>struct_col_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the resulting struct column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>struct_cols</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sequence of columns present in df for combining.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>no_struct_col_type</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.DataTypeSingleton">DataTypeSingleton</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no struct_cols are present, this is the type that the dummy column
to place in the struct will be, default = BooleanType.</p>
              </div>
            </td>
            <td>
                  <code><span title="pyspark.sql.types.BooleanType">BooleanType</span>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>no_struct_col_value</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no struct_cols are present, this is the value that will be used in
the dummy column, default = None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    The input dataframe with the specified struct_cols dropped and replaced</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>with a single struct type column containing those columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If not all the specified struct_cols are present in df.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.convert_struc_col_to_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_struc_col_to_columns</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">convert_nested_structs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Flatten struct columns in pyspark dataframe to individual columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe that may or may not contain struct type columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>convert_nested_structs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, function will recursively call until no structs are left.
Inversely, when false, only top level structs are flattened; if these
contain subsequent structs they would remain.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    The input dataframe but with any struct type columns dropped, and in</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>its place the individual fields within the struct column as individual
columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.count_nulls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">count_nulls</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">subset_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Count the number of null values in the specified columns of a SparkDF.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to analyze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subset_cols</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names or a single column name as a string to count
null values for. If not provided, counts are calculated for all
columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Pandas DataFrame with the count of null values per column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.create_colname_to_value_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_colname_to_value_map</span><span class="p">(</span><span class="n">cols</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a column name to value MapType column.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.create_spark_session" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_spark_session</span><span class="p">(</span><span class="n">app_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;extra-large&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">extra_configs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkSession</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a PySpark Session based on the specified size.</p>
<p>This function creates a PySpark session with different configurations
based on the size specified.</p>
<p>The size can be 'default', 'small', 'medium', 'large', or 'extra-large'.
Extra Spark configurations can be passed as a dictionary.
If no size is given, then a basic Spark session is spun up.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_name</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The spark session app name.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Literal">Literal</span>[&#39;small&#39;, &#39;medium&#39;, &#39;large&#39;, &#39;extra-large&#39;]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the spark session to be created. It can be 'default',
'small', 'medium', 'large', or 'extra-large'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_configs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of additional spark session config settings and the desired
value for it. Will override any default settings.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The created PySpark session.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified 'size' parameter is not one of the valid options:
'small', 'medium', 'large', or 'extra-large'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any other error occurs during the Spark session creation process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span> <span class="o">=</span> <span class="n">create_spark_session</span><span class="p">(</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;spark.ui.enabled&#39;</span><span class="p">:</span> <span class="s1">&#39;false&#39;</span><span class="p">})</span>
</code></pre></div>


<details class="session-details:" open>
  <summary>Session Details:</summary>
  <p>'small':
    This is the smallest session that will realistically be used. It uses
    only 1g of memory and 3 executors, and only 1 core. The number of
    partitions are limited to 12, which can improve performance with
    smaller data. It's recommended for simple data exploration of small
    survey data or for training and demonstrations when several people
    need to run Spark sessions simultaneously.
'medium':
    A standard session used for analysing survey or synthetic datasets.
    Also used for some Production pipelines based on survey and/or smaller
    administrative data.It uses 6g of memory and 3 executors, and 3 cores.
    The number of partitions are limited to 18, which can improve
    performance with smaller data.
'large':
    Session designed for running Production pipelines on large
    administrative data, rather than just survey data. It uses 10g of
    memory and 5 executors, 1g of memory overhead, and 5 cores. It uses the
    default number of 200 partitions.
'extra-large':
    Used for the most complex pipelines, with huge administrative
    data sources and complex calculations. It uses 20g of memory and
    12 executors, 2g of memory overhead, and 5 cores. It uses 240
    partitions; not significantly higher than the default of 200,
    but it is best for these to be a multiple of cores and executors.</p>
</details>

<details class="references" open>
  <summary>References</summary>
  <p>The session sizes and their details are taken directly
from the following resource:
"https://best-practice-and-impact.github.io/ons-spark/spark-overview/example-spark-sessions.html"</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.cumulative_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cumulative_array</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">array_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_colname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert a PySpark array column to a cumulative array column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame containing the array column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>array_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the array column to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_colname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the new column to store the cumulative array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with the cumulative array column added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.cut_lineage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cut_lineage</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the SparkDF to a Java RDD and back again.</p>
<p>This function is helpful in instances where Catalyst optimiser is causing
memory errors or problems, as it only tries to optimise till the conversion
point.</p>
<p>Note: This uses internal members and may break between versions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SparkDF to convert.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New SparkDF created from Java RDD.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any error occurs during the lineage cutting process,
particularly during conversion between SparkDF and Java RDD
or accessing internal members.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">rdd</span><span class="o">.</span><span class="n">toDF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">cut_lineage</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">3</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.drop_duplicates_reproducible" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">drop_duplicates_reproducible</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">id_col</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove duplicates from a PySpark DataFrame in a repeatable manner.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column to partition by for removing duplicates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_col</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column to use for ordering within each partition. If None, a
unique ID column is generated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with duplicates removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.filter_out_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_out_values</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">values_to_exclude</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="n">keep_nulls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exclude rows whose column value appears in the exclusion list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column to filter on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values_to_exclude</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="int">int</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of values to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keep_nulls</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to preserve NULL values in the column.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>values_to_exclude</code> is empty.
If <code>column</code> is not found in <code>df</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtered DataFrame with specified values excluded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li><code>isin</code> performs exact matching. For reliable filtering of floating-point data,
  prefer defining the column as DoubleType.</li>
<li>FloatType columns may suffer from binary precision issues,
  causing literal comparisons to fail unexpectedly.</li>
<li>If you must filter on FloatType with approximate values, consider:</li>
<li>Rounding the column to a fixed precision:
     <code>python
     df = df.withColumn("col", F.round(F.col("col"), 2))
     filter_out_values(df, "col", [1.23, 4.56])</code></li>
<li>Filtering by range to capture an approximate match:
     <code>python
     df.filter(~((F.col("col") &gt;= 1.229) &amp; (F.col("col") &lt;= 1.231)))</code></li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <h4 id="rdsa_utils.helpers.pyspark.filter_out_values--keep-nulls-default">Keep nulls (default)</h4>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;fruit&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filter_out_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;fruit&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+------+</span>
<span class="go">| id| fruit|</span>
<span class="go">+---+------+</span>
<span class="go">|  2|  null|</span>
<span class="go">|  3|banana|</span>
<span class="go">+---+------+</span>
</code></pre></div>
    <h4 id="rdsa_utils.helpers.pyspark.filter_out_values--exclude-nulls">Exclude nulls</h4>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_out_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;fruit&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">],</span> <span class="n">keep_nulls</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---+------+</span>
<span class="go">| id| fruit|</span>
<span class="go">+---+------+</span>
<span class="go">|  3|banana|</span>
<span class="go">+---+------+</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.find_spark_dataframes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_spark_dataframes</span><span class="p">(</span><span class="n">locals_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">SparkDF</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">SparkDF</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract SparkDF's objects from a given dictionary.</p>
<p>This function scans the dictionary and returns another containing only
entries where the value is a SparkDF. It also handles dictionaries within
the input, including them in the output if their first item is a SparkDF.</p>
<p>Designed to be used with locals() in Python, allowing extraction of
all SparkDF variables in a function's local scope.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>locals_dict</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="pyspark.sql.DataFrame">DataFrame</span>, <span title="typing.Dict">Dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary usually returned by locals(), with variable names
as keys and their corresponding objects as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with entries from locals_dict where the value is a
SparkDF or a dictionary with a SparkDF as its first item.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dfs</span> <span class="o">=</span> <span class="n">find_spark_dataframes</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.get_unique" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_unique</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">remove_null</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a list of unique values in a PySpark DataFrame column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame containing the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to analyze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove_null</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to remove null values from output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to log the number of unique values. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of unique values from the specified column.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.get_window_spec" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_window_spec</span><span class="p">(</span><span class="n">partition_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">order_cols</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WindowSpec</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return ordered and partitioned WindowSpec, defaulting to whole df.</p>
<p>Particularly useful when you don't know if the variable being used for
partition_cols will contain values or not in advance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>partition_cols</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If present the columns to partition a spark dataframe on.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order_cols</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If present the columns to order a spark dataframe on (where order in
sequence is order that orderBy is applied).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.WindowSpec">WindowSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The WindowSpec object to be applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="usage" open>
  <summary>Usage</summary>
  <p>window_spec = get_window_spec(...)</p>
<p>F.sum(values).over(window_spec)</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.is_df_empty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_df_empty</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check whether a spark dataframe contains any records.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.join_multi_dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">join_multi_dfs</span><span class="p">(</span><span class="n">df_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SparkDF</span><span class="p">],</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">how</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Join multiple Spark SparkDFs together.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Spark SparkDFs to join.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column(s) on which to join the SparkDFs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>how</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of join to perform (e.g., 'inner', 'outer', 'left', 'right').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SparkDF that is the result of joining all SparkDFs in the list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.load_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_csv</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">keep_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rename_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">drop_columns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a CSV file into a PySpark DataFrame.</p>
<p>spark
    Active SparkSession.
filepath
    The full path and filename of the CSV file to load.
keep_columns
    A list of column names to keep in the DataFrame, dropping all others.
    Default value is None.
rename_columns
    A dictionary to rename columns where keys are existing column
    names and values are new column names.
    Default value is None.
drop_columns
    A list of column names to drop from the DataFrame.
    Default value is None.
kwargs
    Additional keyword arguments to pass to the <code>spark.read.csv</code> method.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PySpark DataFrame containing the data from the CSV file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Transformation order:
1. Columns are kept according to <code>keep_columns</code>.
2. Columns are dropped according to <code>drop_columns</code>.
3. Columns are renamed according to <code>rename_columns</code>.</p>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an error loading the file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a column specified in rename_columns, drop_columns, or
keep_columns is not found in the DataFrame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Load a CSV file with multiline and rename columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span>
<span class="go">        spark,</span>
<span class="go">        &quot;/path/to/file.csv&quot;,</span>
<span class="go">        multiLine=True,</span>
<span class="go">        rename_columns={&quot;old_name&quot;: &quot;new_name&quot;}</span>
<span class="go">    )</span>
</code></pre></div>
    <p>Load a CSV file with a specific encoding:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/path/to/file.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ISO-8859-1&quot;</span><span class="p">)</span>
</code></pre></div>
    <p>Load a CSV file and keep only specific columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/path/to/file.csv&quot;</span><span class="p">,</span> <span class="n">keep_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">])</span>
</code></pre></div>
    <p>Load a CSV file and drop specific columns:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/path/to/file.csv&quot;</span><span class="p">,</span> <span class="n">drop_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">])</span>
</code></pre></div>
    <p>Load a CSV file with custom delimiter and multiline:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">load_csv</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s2">&quot;/path/to/file.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">multiLine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.map_column_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">map_column_names</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">mapper</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Map column names to the given values in the mapper.</p>
<p>If the column name is not in the mapper the name doesn't change.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.map_column_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">map_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">dict_</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">input_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_col</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Map PySpark column to dictionary keys.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dict_</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary for mapping values in input_col to new values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column to replace values in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_col</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the new column with replaced values. Defaults to
input_col if not provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with the new column added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.melt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">id_vars</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">value_vars</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Melt a spark dataframe in a pandas like fashion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pyspark dataframe to melt.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>id_vars</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the columns to use as identifier variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value_vars</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the columns containing the data to unpivot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>var_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target column containing variable names
(i.e. the original column names).</p>
              </div>
            </td>
            <td>
                  <code>&#39;variable&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the target column containing the unpivoted
data.</p>
              </div>
            </td>
            <td>
                  <code>&#39;value&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The "melted" input data as a pyspark data frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+----+--------+-----+</span>
<span class="go">|col1|variable|value|</span>
<span class="go">+----+--------+-----+</span>
<span class="go">|   1|    col2|    2|</span>
<span class="go">|   1|    col3|    3|</span>
<span class="go">|   5|    col2|    6|</span>
<span class="go">|   5|    col3|    7|</span>
<span class="go">|   9|    col2|   10|</span>
<span class="go">|   9|    col3|   11|</span>
<span class="go">+----+--------+-----+</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+----+----+--------+-----+</span>
<span class="go">|col1|col2|variable|value|</span>
<span class="go">+----+----+--------+-----+</span>
<span class="go">|   1|   2|    col3|    3|</span>
<span class="go">|   1|   2|    col4|    4|</span>
<span class="go">|   5|   6|    col3|    7|</span>
<span class="go">|   5|   6|    col4|    8|</span>
<span class="go">|   9|  10|    col3|   11|</span>
<span class="go">|   9|  10|    col4|   12|</span>
<span class="go">+----+----+--------+-----+</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.pyspark_random_uniform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pyspark_random_uniform</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">output_colname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Mimic numpy.random.uniform for PySpark.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to which the column will be added.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_colname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the new column to be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower_bound</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The lower bound of the uniform distribution. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper_bound</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The upper bound of the uniform distribution. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for random number generation. Defaults to None for
non-deterministic results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with the new column added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.rank_numeric" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rank_numeric</span><span class="p">(</span><span class="n">numeric</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">group</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rank a numeric and assign a unique value to each row.</p>
<p>The <code>F.row_number()</code> method has been selected as a method to rank as
gives a unique number to each row. Other methods such as <code>F.rank()</code>
and <code>F.dense_rank()</code> do not assign unique values per row.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>numeric</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column name or list of column names containing values which will
be ranked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>group</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grouping levels to rank the numeric column or columns over.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ascending</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictates whether high or low values are ranked as the top value.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.Column">Column</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains a rank for the row in its grouping level.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.select_first_obs_appearing_in_group" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_first_obs_appearing_in_group</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">date_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ascending</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Rank and select observation in group based on earliest or latest date.</p>
<p>Given that there can be multiple observations per group, select
observation that appears first or last (depending on whether ascending is
set to True or False, respectively).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input dataframe that contains the group and date_col.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>group</code>
            </td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The grouping levels required to find the observation that appears first
or last (depending on whether ascending is set to True or False,
respectively)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>date_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name containing the dates of each observation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ascending</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictates whether first or last observation within a grouping is
selected (depending on whether ascending is set to True or False,
respectively).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input dataframe that contains each observation per group that
appeared first or last (depending on whether ascending is set to
True or False, respectively) according to date_col.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.set_df_columns_nullable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_df_columns_nullable</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">column_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">nullable</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Change specified columns nullable value.</p>
<p>Sometimes find that spark creates columns that have the nullable attribute
set to False, which can cause issues if this dataframe is saved to a table
as it will set the schema for that column to not allow missing values.</p>
<p>Changing this parameter for a column appears to be very difficult (and also
potentially costly [see so answer comments] - SO USE ONLY IF NEEDED).</p>
<p>The solution implemented is taken from Stack Overflow post:
https://stackoverflow.com/a/51821437</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataframe with columns to have nullable attribute changed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of columns to change nullable attribute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nullable</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to set the nullable attribute to for the specified columns.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input dataframe but with nullable attribute changed for specified
columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.set_nulls" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_nulls</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">column</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Replace specified values with nulls in given column of PySpark df.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column in which to replace values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value(s) to replace with nulls.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with specified values replaced by nulls.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.smart_coalesce" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">smart_coalesce</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">target_file_size_mb</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Coalesce a Spark DataFrame to an appropriate number of partitions.</p>
<p>Coalesces a Spark DataFrame to an appropriate number of partitions based on its
estimated size using Spark's Catalyst optimiser and a user-defined target file size.</p>
<p>This function helps to reduce the number of output files written when saving a
DataFrame to storage systems such as Hive or Amazon S3 by adjusting the number of
partitions using <code>.coalesce()</code>. It is especially useful for avoiding the
"small files problem", which can negatively affect performance,
metadata management, and query planning.</p>
<p>It leverages Spark Catalyst's query plan statistics to get a logical estimate
of the DataFrame's size in bytes without triggering a full job or action.
Based on the provided <code>target_file_size_mb</code>, it calculates how many output files
are needed and reduces the number of partitions accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input Spark DataFrame that will be written to storage.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_file_size_mb</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired maximum size of each output file in megabytes. This controls the
number of output files by estimating how many are needed to approximately
match the total data volume.
Default is 512 MB.</p>
              </div>
            </td>
            <td>
                  <code>512</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Spark DataFrame with a reduced number of partitions, ready to be written
to disk using <code>.write()</code>. The number of partitions is chosen to produce
output files close to the target size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>This function uses Spark Catalyst's logical plan statistics. These may be
  outdated or unavailable if statistics haven't been collected
  (e.g., ANALYZE TABLE not run).</li>
<li>If the estimated size is zero or unavailable, it defaults to a single partition.</li>
<li>This function uses <code>.coalesce()</code> which avoids a shuffle but can cause skew if the
  data is unevenly distributed. For very large datasets, consider using
  <code>repartition()</code> instead.</li>
<li>This function is best used as a final optimisation before writing output files,
  especially to S3, Hive, or HDFS.</li>
</ul>
</details>

<details class="why-small-files-are-a-problem" open>
  <summary>Why Small Files Are a Problem</summary>
  <p>Writing many small files (e.g., thousands of files per partition)
negatively impacts:</p>
<ol>
<li>Hive Metastore:</li>
<li>Hive must track every individual file in the metastore.</li>
<li>
<p>Too many files lead to slow table listings, metadata queries,
     and planning time.</p>
</li>
<li>
<p>Spark Performance:</p>
</li>
<li>During reads, Spark spawns a task per file.</li>
<li>
<p>Thousands of tiny files = thousands of tasks =
     job scheduling overhead + slow query startup.</p>
</li>
<li>
<p>S3 Performance:</p>
</li>
<li>S3 is object storage, not a filesystem. Each file written = one PUT request.</li>
<li>Too many files increase write latency and cost.</li>
<li>During reads, many GET requests slow down performance.</li>
</ol>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Reduce number of output files for a moderate-sized DataFrame:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">coalesced_df</span> <span class="o">=</span> <span class="n">smart_coalesce</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_file_size_mb</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coalesced_df</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">saveAsTable</span><span class="p">(</span><span class="s2">&quot;my_optimised_table&quot;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.sum_columns" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sum_columns</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">cols_to_sum</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">output_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate row-wise sum of specified PySpark columns.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The PySpark DataFrame to modify.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols_to_sum</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to sum together.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the new column to create with the sum.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SparkDF with the new column added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.to_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_list</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert Spark DF to a list.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>list or list of lists</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input DataFrame has a single column then a list of column
values will be returned. If the DataFrame has multiple columns
then a list of row data as lists will be returned.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.to_spark_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_spark_col</span><span class="p">(</span><span class="n">_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">exclude</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert str args to Spark Column if not already.</p>


<details class="usage" open>
  <summary>Usage</summary>
  <p>Use as a decorator on a function.</p>
<p>To convert all string arguments to spark column</p>
<blockquote>
<blockquote>
<blockquote>
<p>@to_spark_col
def my_func(arg1, arg2)</p>
</blockquote>
</blockquote>
</blockquote>
<p>To exclude a string arguments from being converted to a spark column</p>
<blockquote>
<blockquote>
<blockquote>
<p>@to_spark_col(exclude=['arg2'])
def my_func(arg1, arg2)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Chain Pyspark function.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.truncate_external_hive_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">truncate_external_hive_table</span><span class="p">(</span><span class="n">spark</span><span class="p">:</span> <span class="n">SparkSession</span><span class="p">,</span> <span class="n">table_identifier</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Truncate an External Hive table stored on S3 or HDFS.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spark</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.SparkSession">SparkSession</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Active SparkSession.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table_identifier</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Hive table to truncate. This can either be in the format
'<database>.<table>' or simply '<table>' if the current Spark session
has a database set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function does not return any value. It performs an action of
truncating the table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the table name is incorrectly formatted, the database is not provided
when required, or if the table does not exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AnalysisException">AnalysisException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is an issue with partition operations or SQL queries.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If there is a general failure during the truncation process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Truncate a Hive table named 'my_database.my_table':</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_external_hive_table</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s1">&#39;my_database.my_table&#39;</span><span class="p">)</span>
</code></pre></div>
    <p>Or, if the current Spark session already has a database set:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">spark</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">setCurrentDatabase</span><span class="p">(</span><span class="s1">&#39;my_database&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">truncate_external_hive_table</span><span class="p">(</span><span class="n">spark</span><span class="p">,</span> <span class="s1">&#39;my_table&#39;</span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.union_mismatched_dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">union_mismatched_dfs</span><span class="p">(</span><span class="n">df1</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">df2</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform a union between PySpark DataFrames with mismatched column names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df1</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df2</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second PySpark DataFrame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SparkDF resulting from the union of df1 and df2, with missing
columns filled with null values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.union_multi_dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">union_multi_dfs</span><span class="p">(</span><span class="n">df_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SparkDF</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform a union on all SparkDFs in the provided list.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>All SparkDFs must have the same columns.</p>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_list</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="pyspark.sql.DataFrame">DataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of PySpark DataFrames to union.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SparkDF that is the result of the union of all SparkDFs in the list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.pyspark.unpack_list_col" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unpack_list_col</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">SparkDF</span><span class="p">,</span> <span class="n">list_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unpacked_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkDF</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Unpack a spark column containing a list into multiple rows.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains the list column to unpack.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column which contains lists.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unpacked_col</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the column containing the unpacked list items.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyspark.sql.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Contains a new row for each unpacked list item.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.helpers.python" class="doc doc-heading">
            <code>rdsa_utils.helpers.python</code>


</h2>

    <div class="doc doc-contents first">

        <p>Miscellaneous helper functions for Python.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.always_iterable_local" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">always_iterable_local</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Supplement more-itertools <code>always_iterable</code> to also exclude dicts.</p>
<p>By default it would convert a dictionary to an iterable of just its keys,
dropping all the values. This change makes it so dictionaries are not
altered (similar to how strings aren't broken down).</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.calc_product_of_dict_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calc_product_of_dict_values</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create cartesian product of values for each kwarg.</p>
<p>In order to create product of values, the values are converted to
a list so that product of values can be derived.</p>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>    Next result of cartesian product of kwargs values.</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>my_dict = {
    'key1': 1,
    'key2': [2, 3, 4]
}</p>
<p>list(calc_product_of_dict_values(**my_dict))</p>
<blockquote>
<blockquote>
<blockquote>
<p>[{'key1': 1, 'key2': 2}, {'key1': 1, 'key2': 3}, {'key1': 1, 'key2': 4}]</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <p>Modified from: https://stackoverflow.com/a/5228294</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.check_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_file</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if a file exists on the local file system and meets specific criteria.</p>
<p>This function checks whether the given path corresponds to a valid file
on the local or network file system. It ensures the file exists, is not
a directory, and its size is greater than zero bytes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a local/network file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists, is not a directory, and size &gt; 0,
otherwise False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>check_file("folder/file.txt")
True
check_file("folder/file_0_bytes.txt")
False</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.convert_date_strings_to_datetimes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_date_strings_to_datetimes</span><span class="p">(</span><span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert start and end dates from strings to timestamps.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datetime like object which is used to define the start date for filter.
Acceptable string formats include (but not limited to): MMMM YYYY,
YYYY-MM, YYYY-MM-DD, DD MMM YYYY etc. If only month and year specified
the start_date is set as first day of month.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_date</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Datetime like object which is used to define the start date for filter.
Acceptable string formats include (but not limited to): MMMM YYYY,
YYYY-MM, YYYY-MM-DD, DD MMM YYYY etc. If only month and year specified
the end_date is set as final day of month.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="pandas.Timestamp">Timestamp</span>, <span title="pandas.Timestamp">Timestamp</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple where the first value is the start date and the second the end
date.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.convert_types_iterable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_types_iterable</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the data type of elements in an iterable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The iterable whose elements are to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target data type to which elements in the iterable should be
converted. Defaults to <code>float</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new list with elements converted to the specified data type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_types_iterable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">[1.0, 2.0, 3.0]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_types_iterable</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[&#39;10&#39;, &#39;20&#39;, &#39;30&#39;]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_types_iterable</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">ord</span><span class="p">)</span>
<span class="go">[97, 98, 99]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">convert_types_iterable</span><span class="p">([</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="go">[10, 20, 30]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.create_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_folder</span><span class="p">(</span><span class="n">dirpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a directory on a local network drive.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dirpath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the directory to create.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory will be created if it does not already exist,
including parent directories.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>create_folder("example_folder/subfolder")</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="rdsa_utils.helpers.python.create_folder--the-directory-example_foldersubfolder-will-be-created-if-it-does-not-exist">The directory "example_folder/subfolder" will be created if it does not exist.</h4>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.directory_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">directory_exists</span><span class="p">(</span><span class="n">dirpath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Test if given path is a directory on the local file system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dirpath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory path to check exists.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the dirpath is a directory, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>directory_exists("folder")
True
directory_exists("non_existing_folder")
dirpath='.../non_existing_folder' cannot be found.
False</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.dump_environment_requirements" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dump_environment_requirements</span><span class="p">(</span><span class="n">output_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pip&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;--format=freeze&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Dump the current Python environment dependencies to a text file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the output text file where the list of dependencies will be saved.
If the directory does not exist, it will be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tool</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The command-line tool to use for exporting dependencies
(e.g. 'pip', 'poetry', or 'uv').
Default is 'pip'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pip&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>args</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The arguments to pass to the selected tool.
For pip, the default is ['list', '--format=freeze'].
For poetry, a common option is ['export', '--without-hashes'].
For uv, you might use ['pip', 'freeze'].</p>
              </div>
            </td>
            <td>
                  <code>[&#39;list&#39;, &#39;--format=freeze&#39;]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function writes to the specified file and does not return anything.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dump_environment_requirements</span><span class="p">(</span><span class="s2">&quot;requirements.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dump_environment_requirements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;requirements.txt&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;pip&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;freeze&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dump_environment_requirements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;requirements.txt&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;poetry&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;export&quot;</span><span class="p">,</span> <span class="s2">&quot;--without-hashes&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dump_environment_requirements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;requirements.txt&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">tool</span><span class="o">=</span><span class="s2">&quot;uv&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;freeze&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.extend_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extend_lists</span><span class="p">(</span><span class="n">sections</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">elements_to_add</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check list elements are unique then append to existing list.</p>
<p>Note the <code>.extend</code> method in Python overwrites each section. There
is no need to assign a variable to this function, the section will
update automatically.</p>
<p>The function can be used with the <code>load_config</code> function to extend a
value list in a config yaml file. For example with a <code>config.yaml</code>
file as per below:</p>
<pre><code>input_columns
    - col_a
    - col_b

output_columns
    - col_b
</code></pre>
<p>To add column <code>col_c</code> the function can be utilised as follows:</p>
<pre><code>config = load_config(&quot;config.yaml&quot;)

sections = [config['input_columns'], config['output_columns']]
elements_to_add = ['col_c']

extend_lists(sections, elements_to_add)
</code></pre>
<p>The output will be as follows.</p>
<pre><code>input_columns
    - col_a
    - col_b
    - col_c

output_columns
    - col_b
    - col_c
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sections</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The section to be updated with the extra elements.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>elements_to_add</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new elements to add to the specified sections.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Note the <code>.extend</code> method in Python overwrites the sections.
There is no need to assign a variable to this function, the
section will update automatically.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.file_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Test if file exists on the local file system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filepath of file check exists.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the file exists, else False.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>file_exists("folder/file.txt")
True
file_exists("folder/non_existing_file.txt")
filepath='.../folder/non_existing_file.txt' cannot be found.
False</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.file_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">file_size</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the size of the file from the network drive in bytes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filepath of file to check for size.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer value indicating the size of the file in bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>file_size("folder/file.txt")
90
file_size("folder/non_existing_file.txt")
FileNotFoundError: filepath='.../folder/non_existing_file.txt' cannot be found.</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.flatten_iterable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">flatten_iterable</span><span class="p">(</span><span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">types_to_flatten</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">type</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n">List</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Flatten an iterable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iterable</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable that may contain elements of various types.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>types_to_flatten</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="type">type</span>, <span title="typing.Tuple">Tuple</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type(s) that should be flattened. Defaults to (list, tuple).</p>
              </div>
            </td>
            <td>
                  <code>(<span title="list">list</span>, <span title="tuple">tuple</span>)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flattened list with all elements from the input iterable, with
specified types unpacked.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_iterable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;abc&#39;</span><span class="p">])</span>
<span class="go">[1, 2, 3, 4, 5, &#39;abc&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_iterable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;abc&#39;</span><span class="p">],</span> <span class="n">types_to_flatten</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="go">[1, 2, 3, (4, 5), &#39;abc&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_iterable</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;bc&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]],</span> <span class="n">types_to_flatten</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flatten_iterable</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">types_to_flatten</span><span class="o">=</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span>
<span class="go">(1, 2, 3, 4, 5, &#39;abc&#39;)</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.interleave_iterables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">interleave_iterables</span><span class="p">(</span><span class="n">iterable1</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">iterable2</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Interleave two iterables element by element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iterable1</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first iterable to interleave.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iterable2</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second iterable to interleave.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new list with elements from <code>iterable1</code> and <code>iterable2</code> interleaved.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If either of the inputs is not an iterable of types: list, tuple,
string, or range.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the lengths of the two iterables do not match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interleave_iterables</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">[1, 4, 2, 5, 3, 6]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interleave_iterables</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">))</span>
<span class="go">[1, &#39;a&#39;, 2, &#39;b&#39;, 3, &#39;c&#39;]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interleave_iterables</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;123&#39;</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;1&#39;, &#39;B&#39;, &#39;2&#39;, &#39;C&#39;, &#39;3&#39;]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interleave_iterables</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="go">[0, 10, 1, 11, 2, 12]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.list_convert" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_convert</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert object to list using more-itertools' <code>always_iterable</code>.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.md5_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">md5_sum</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get md5sum of a specific file on the local file system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filepath of file to create md5 hash from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The md5sum of the file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>md5_sum("folder/file.txt")
"d41d8cd98f00b204e9800998ecf8427e"
md5_sum("folder/non_existing_file.txt")
FileNotFoundError: filepath='../folder/non_existing_file.txt' cannot be found.</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.merge_multi_dfs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_multi_dfs</span><span class="p">(</span><span class="n">df_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">on</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">how</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fillna_val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform consecutive merges on a list of pandas DataFrames.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_list</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of DataFrames to be merged.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="list">list</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name(s) to merge on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>how</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of merge to be performed. Must be one of 'left', 'right', 'outer',
'inner'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fillna_val</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="object">object</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to replace missing values with. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resulting DataFrame after merging and optional filling of missing
values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>df_list</code> is not a list of pandas DataFrames, or <code>on</code> is not a string
or list of strings, or <code>how</code> is not a string.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the <code>how</code> argument is not one of 'left', 'right', 'outer', or 'inner'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;value1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="s1">&#39;value2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="s1">&#39;value3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merge_multi_dfs</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="go">  key  value1  value2  value3</span>
<span class="go">0   A       1       4       6</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;value1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="s1">&#39;value2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merge_multi_dfs</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span>  <span class="n">fillna_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">  key  value1  value2</span>
<span class="go">0   A        1        4</span>
<span class="go">1   B        2        5</span>
<span class="go">2   C        3        0</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.overwrite_dictionary" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overwrite_dictionary</span><span class="p">(</span><span class="n">base_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">override_dict</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Overwrite dictionary values with user defined values.</p>
<p>The following restrictions are in place:
* base_dict and override_dict have the same value which is not dictionary
  then override_dict has priority.
* If base_dict contains dictionary and override_dict contains a value (e.g.
  string or list) with the same key, priority is upon base_dict and
  the override_dict value is ignored.
* If key is in override_dict but not in base_dict then an Exception is
  raised and code stops.
* Any other restrictions will require code changes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>base_dict</code>
            </td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing existing key value pairs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>override_dict</code>
            </td>
            <td>
                  <code><span title="typing.Mapping">Mapping</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing new keys/values to inset into base_dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base_dict with any keys matching the override_dict being replaced.
Any keys not present in base_dict are appended.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>dic1 = {"var1": "value1", "var2": {"var3": 1.1, "var4": 4.4}, "var5": [1, 2, 3]}
dic2 = {"var2": {"var3": 9.9}}</p>
<p>overwrite_dictionary(dic1, dic2)
{'var1': 'value1', 'var2': {'var3': 9.9, 'var4': 4.4}, 'var5': [1, 2, 3]}</p>
<p>dic3 = {"var2": {"var3": 9.9}, "var6": -1}
overwrite_dictionary(dic1, dic3)
ERROR <strong>main</strong>: ('var6', -1) not in base_dict</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <p>Modified from: https://stackoverflow.com/a/58742155</p>
</details>

<details class="warning" open>
  <summary>Warning</summary>
  <p>Due to recursive nature of function, the function will overwrite the
base_dict object that is passed into the original function.</p>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a key is present in override_dict but not base_dict.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.pairwise_iterable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pairwise_iterable</span><span class="p">(</span><span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">zip</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return pairs of adjacent values from the input iterable.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iterable</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable object (e.g., list, tuple, string) from which pairs of
adjacent values will be generated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="zip">zip</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterator of tuples, each containing a pair of adjacent values
from the input iterable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input is not an iterable.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">pairwise_iterable</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))</span>
<span class="go">[(1, 2), (2, 3), (3, 4)]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">pairwise_iterable</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">))</span>
<span class="go">[(&#39;a&#39;, &#39;b&#39;), (&#39;b&#39;, &#39;c&#39;), (&#39;c&#39;, &#39;d&#39;), (&#39;d&#39;, &#39;e&#39;)]</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">pairwise_iterable</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)))</span>
<span class="go">[(10, 20), (20, 30)]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.read_header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_header</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the first line of a file on the local file system.</p>
<p>Reads the first line and removes the newline/returncarriage symbol.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a local/network file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first line of the file as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>read_header("folder/file.txt")
"This is the first line of the file."
read_header("folder/non_existing_file.txt")
FileNotFoundError: filepath='.../folder/non_existing_file.txt' cannot be found.</p>
</blockquote>
</blockquote>
</blockquote>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.setdiff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setdiff</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a list of elements that are present in <code>a</code> but not in <code>b</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first iterable from which elements are to be selected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>b</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second iterable containing elements to be excluded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of elements that are in <code>a</code> but not in <code>b</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">setdiff</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setdiff</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span><span class="p">,</span> <span class="s1">&#39;bdf&#39;</span><span class="p">)</span>
<span class="go">[&#39;a&#39;, &#39;c&#39;, &#39;e&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setdiff</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">})</span>
<span class="go">[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">setdiff</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">[0, 1]</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.time_it" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">time_it</span><span class="p">(</span><span class="o">*</span><span class="n">timer_args</span><span class="p">,</span> <span class="o">**</span><span class="n">timer_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Measure the execution time of a function, with options to configure Timer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>timer_args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments to pass to the Timer object.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timer_kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to pass to the Timer object.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A wrapped function that includes timing measurement.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>@time_it()
def example_function():
    # Function implementation</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.tuple_convert" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tuple_convert</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert object to tuple using more-itertools' <code>always_iterable</code>.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.helpers.python.write_string_to_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_string_to_file</span><span class="p">(</span><span class="n">content</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Write a string into the specified file path on the local file system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The content to write into the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the file where the content will be written.
If the file already exists, it will be overwritten.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>write_string_to_file(b"Hello, World!", "example.txt")</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="rdsa_utils.helpers.python.write_string_to_file--the-content-hello-world-will-be-written-to-exampletxt">The content "Hello, World!" will be written to "example.txt"</h4>
</details>

    </div>

</div>



  </div>

    </div>

</div><h2 id="io">IO</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.io.config" class="doc doc-heading">
            <code>rdsa_utils.io.config</code>


</h2>

    <div class="doc doc-contents first">

        <p>Module for code relating to loading config files.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="rdsa_utils.io.config.LoadConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LoadConfig</span><span class="p">(</span><span class="n">config_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CloudPath</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">config_overrides</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Config</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;toml&#39;</span><span class="p">,</span> <span class="s1">&#39;yaml&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">config_validators</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Class for loading and storing a configuration file.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config">config</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded config stored as a dictionary.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_dir">config_dir</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logical parent directory of loaded <code>config_path</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_file">config_file</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file name of the loaded <code>config_path</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_original">config_original</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration dictionary as initially loaded, prior to applying any
overrides or validation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_overrides">config_overrides</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration override dictionary, if provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_path">config_path</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the loaded config file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_type">config_type</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file type of the loaded config file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.config_validators">config_validators</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validators used to validate the loaded config, if provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="rdsa_utils.io.config.LoadConfig.**attrs">**attrs</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Every top level key in the loaded config is also set as an attribute to
allow simpler access to each config section.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>Init method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="cloudpathlib.CloudPath">CloudPath</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path of the config file to be loaded.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_overrides</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="rdsa_utils.typing.Config">Config</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing a subset of the keys and values of the
config file that is initially loaded, by default None. If values
are provided that are not in the initial config then a ConfigError
is raised.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optional</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="rdsa_utils.typing.Config">Config</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing a subset of the keys and values of the
config file that is initially loaded, by default None. If values
are provided that are not in the initial config then a ConfigError
is raised.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Literal">Literal</span>[&#39;json&#39;, &#39;toml&#39;, &#39;yaml&#39;]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file type of the config file being loaded, by default None. If
not specified then this is inferred from the <code>config_path</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optional</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Literal">Literal</span>[&#39;json&#39;, &#39;toml&#39;, &#39;yaml&#39;]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file type of the config file being loaded, by default None. If
not specified then this is inferred from the <code>config_path</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_validators</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pydantic.BaseModel">BaseModel</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary made up of key, value pairs where the keys refer to
the top level sections of the loaded config, and the values are a
pydantic validation class for the section, by default None. If only
some of the keys are specified with validators, warnings are raised
to alert that they have not been validated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optional</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="pydantic.BaseModel">BaseModel</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary made up of key, value pairs where the keys refer to
the top level sections of the loaded config, and the values are a
pydantic validation class for the section, by default None. If only
some of the keys are specified with validators, warnings are raised
to alert that they have not been validated.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.io.input" class="doc doc-heading">
            <code>rdsa_utils.io.input</code>


</h2>

    <div class="doc doc-contents first">

        <p>Module containing generic input functionality code.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.io.input.parse_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_json</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse JSON formatted string into a dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String containing standard JSON-formatted data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rdsa_utils.typing.Config">Config</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the parsed data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="json.decoder.JSONDecodeError">JSONDecodeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the string format of config_overrides cannot be decoded by
json.loads (i.e. converted to a dictionary).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.io.input.parse_toml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_toml</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse TOML formatted string into a dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String containing standard TOML-formatted data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rdsa_utils.typing.Config">Config</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the parsed data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.io.input.parse_yaml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_yaml</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse YAML formatted string into a dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String containing standard YAML-formatted data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rdsa_utils.typing.Config">Config</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the parsed data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.io.input.read_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">CloudPath</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load contents of specified file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="cloudpathlib.CloudPath">CloudPath</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The absolute file path of the file to be read.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contents of the provided file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the provided file does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.io.output" class="doc doc-heading">
            <code>rdsa_utils.io.output</code>


</h2>

    <div class="doc doc-contents first">

        <p>Module containing generic output functionality code.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.io.output.zip_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">zip_folder</span><span class="p">(</span><span class="n">source_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Zip the contents of the specified directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory whose contents are to be zipped.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The output zip file name. It must end with '.zip'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the existing zip file if it exists.
Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the directory was zipped successfully, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">zip_folder</span><span class="p">(</span><span class="s1">&#39;/path/to/source_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;output.zip&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div><h2 id="methods">Methods</h2>


<div class="doc doc-object doc-module">



<h2 id="rdsa_utils.methods.averaging_methods" class="doc doc-heading">
            <code>rdsa_utils.methods.averaging_methods</code>


</h2>

    <div class="doc doc-contents first">

        <p>Weighted and unweighted averaging functions.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.methods.averaging_methods.get_weight_shares" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_weight_shares</span><span class="p">(</span><span class="n">weights</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Divide weights by sum of weights for each group.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.methods.averaging_methods.unweighted_arithmetic_average" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unweighted_arithmetic_average</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the unweighted arithmetic average.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.methods.averaging_methods.unweighted_geometric_average" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">unweighted_geometric_average</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the unweighted geometric average.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.methods.averaging_methods.weighted_arithmetic_average" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">weighted_arithmetic_average</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the weighted arithmetic average.</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="rdsa_utils.methods.averaging_methods.weighted_geometric_average" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">weighted_geometric_average</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">weight</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SparkCol</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the weighted geometric average.</p>


    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 23, 2025 22:14:38 UTC">July 23, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          

          <!-- User preference: content -->
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>

        <!-- Back-to-top button -->
        
      </main>

      <!-- Footer -->
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  <div class="md-copyright__highlight">
    <img
      src="../assets/images/govuk-crest.svg"
      width="60px"
      height="60px"
    />
    <p>&copy;  <a href="https://www.ons.gov.uk">Office for National Statistics 2024</a>
</p>
  </div>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="<insert repo link>" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>

    <!-- Dialog -->
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>

    <!-- Progress indicator -->
    

    <!-- Consent -->
    

    <!-- Theme-related configuration -->
    <!-- Versioning --><!-- Tags --><!-- Translations --><!-- Configuration -->
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    

    <!-- Theme-related JavaScript -->
    
      <script src="../assets/javascripts/bundle.js"></script>

      <!-- Custom JavaScript -->
      
    
  </body>
</html>